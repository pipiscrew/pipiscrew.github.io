<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.6.2"><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="SHA hash + ToBase64String" /><meta name="author" content="PipisCrew" /><meta property="og:locale" content="en_US" /><meta name="description" content="ASP Classic, Code for SHA hash using mscorlib.dll" /><meta property="og:description" content="ASP Classic, Code for SHA hash using mscorlib.dll" /><link rel="canonical" href="/posts/sha-hash-t/" /><meta property="og:url" content="/posts/sha-hash-t/" /><meta property="og:site_name" content="PipisCrew" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-11-27T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="SHA hash + ToBase64String" /><meta name="twitter:site" content="@pipiscrew" /><meta name="twitter:creator" content="@PipisCrew" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@type":"BlogPosting","url":"/posts/sha-hash-t/","headline":"SHA hash + ToBase64String","dateModified":"2018-11-27T00:00:00+08:00","datePublished":"2018-11-27T00:00:00+08:00","author":{"@type":"Person","name":"PipisCrew"},"mainEntityOfPage":{"@type":"WebPage","@id":"/posts/sha-hash-t/"},"description":"ASP Classic, Code for SHA hash using mscorlib.dll","@context":"https://schema.org"}</script><title>SHA hash + ToBase64String | PipisCrew</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">PipisCrew</a></div><div class="site-subtitle font-italic">A text-focused Jekyll theme.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG â€º <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/pipiscrew" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/pipiscrew" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>SHA hash + ToBase64String</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>SHA hash + ToBase64String</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Nov 27, 2018, 12:00 AM +0800" > Nov 27, 2018 <i class="unloaded">2018-11-27T00:00:00+08:00</i> </span> by <span class="author"> PipisCrew </span></div></div><div class="post-content"><h2 id="asp-classic-code-for-sha-hash-using-mscorlibdll">ASP Classic, Code for SHA hash using mscorlib.dll</h2><div class="language-js highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre><td class="rouge-code"><pre><span class="o">&lt;%</span>
<span class="nx">dim</span> <span class="nx">concat_str</span>

<span class="nx">concat_str</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1030204645TT3343PipisCrew Order3.10EURDEMO@PIPISCREW.COM1http://localhost/success.htmlhttp://localhost:1400/cancel.html?orderId=13564MediaLink</span><span class="dl">"</span>

<span class="dl">'</span><span class="s1">Borrow some objects from .NET
Set ccc = CreateObject("System.Text.UTF8Encoding")
Set enc = CreateObject("System.Security.Cryptography.SHA1CryptoServiceProvider") 

</span><span class="dl">'</span><span class="nx">Convert</span> <span class="nx">the</span> <span class="nx">string</span> <span class="nx">to</span> <span class="nx">a</span> <span class="nx">byte</span> <span class="nx">array</span> <span class="nx">and</span> <span class="nx">hash</span> <span class="nx">it</span>
<span class="nx">bytes</span> <span class="o">=</span> <span class="nx">ccc</span><span class="p">.</span><span class="nx">GetBytes_4</span><span class="p">(</span><span class="nx">concat_str</span><span class="p">)</span>
<span class="nx">bytes</span> <span class="o">=</span> <span class="nx">enc</span><span class="p">.</span><span class="nx">ComputeHash_2</span><span class="p">((</span><span class="nx">bytes</span><span class="p">))</span> 
<span class="dl">'</span><span class="s1">Convert the byte array to a hex string

</span><span class="dl">'</span><span class="mi">1</span><span class="nx">st</span> <span class="nx">way</span>
<span class="dl">'</span><span class="s1">zRRNmrTgh1lwz5HHj8HoGZ6wjms=
digest = encodeBase64(bytes)

</span><span class="dl">'</span><span class="mi">2</span><span class="nx">nd</span> <span class="nx">way</span>
<span class="dl">'</span><span class="s1">zRRNmrTgh1lwz5HHj8HoGZ6wjms=
digest = ToBase64String(bytes)

</span><span class="dl">'</span><span class="nx">notice</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">ToBase64String</span><span class="o">/</span><span class="nx">encodeBase64</span> <span class="nx">output</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">same</span> <span class="kd">with</span> <span class="k">this</span> <span class="nx">piece</span> <span class="k">of</span> <span class="nx">PHP</span> <span class="nx">code</span>
<span class="dl">'</span><span class="s1">&lt;?php
</span><span class="dl">'</span><span class="nx">$digest</span> <span class="o">=</span> <span class="nx">base64_encode</span><span class="p">(</span><span class="nx">sha1</span><span class="p">(</span><span class="dl">"</span><span class="s2">1030204645TT3343PipisCrew Order3.10EURDEMO@PIPISCREW.COM1http://localhost/success.htmlhttp://localhost:1400/cancel.html?orderId=13564MediaLink</span><span class="dl">"</span><span class="p">,</span><span class="kc">true</span><span class="p">));</span>
<span class="dl">'</span><span class="s1">
</span><span class="dl">'</span><span class="nx">echo</span> <span class="nx">$digest</span><span class="p">;</span>
<span class="dl">'</span><span class="s1">?&gt;

Response.Write(digest)

Function ToBase64String(rabyt)

  </span><span class="dl">'</span><span class="nx">Ref</span><span class="p">:</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//stackoverflow.com/questions/1118947/converting-binary-file-to-base64-string</span>
  <span class="nx">Dim</span> <span class="nx">xml</span><span class="p">:</span> <span class="nb">Set</span> <span class="nx">xml</span> <span class="o">=</span> <span class="nx">CreateObject</span><span class="p">(</span><span class="dl">"</span><span class="s2">MSXML2.DOMDocument.3.0</span><span class="dl">"</span><span class="p">)</span>
  <span class="nx">xml</span><span class="p">.</span><span class="nx">LoadXml</span> <span class="dl">"</span><span class="s2">&lt;root/&gt;</span><span class="dl">"</span>
  <span class="nx">xml</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">dataType</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">bin.base64</span><span class="dl">"</span>
  <span class="nx">xml</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">nodeTypedValue</span> <span class="o">=</span> <span class="nx">rabyt</span>
  <span class="nx">ToBase64String</span> <span class="o">=</span> <span class="nx">Replace</span><span class="p">(</span><span class="nx">xml</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">Text</span><span class="p">,</span><span class="nx">VbLf</span><span class="p">,</span> <span class="dl">""</span><span class="p">)</span>

<span class="nx">End</span> <span class="nb">Function</span>

<span class="nb">Function</span> <span class="nx">encodeBase64</span><span class="p">(</span><span class="nx">bytes</span><span class="p">)</span>
	<span class="nx">dim</span> <span class="nx">DM</span><span class="p">,</span> <span class="nx">EL</span>
	<span class="nb">Set</span> <span class="nx">DM</span> <span class="o">=</span> <span class="nx">CreateObject</span><span class="p">(</span><span class="dl">"</span><span class="s2">Microsoft.XMLDOM</span><span class="dl">"</span><span class="p">)</span>
	<span class="dl">'</span><span class="s1"> Create temporary node with Base64 data type
	Set EL = DM.createElement("tmp")
	EL.DataType = "bin.base64"
	</span><span class="dl">'</span> <span class="nb">Set</span> <span class="nx">bytes</span><span class="p">,</span> <span class="kd">get</span> <span class="nx">encoded</span> <span class="nb">String</span>
	<span class="nx">EL</span><span class="p">.</span><span class="nx">NodeTypedValue</span> <span class="o">=</span> <span class="nx">bytes</span>
	<span class="nx">encodeBase64</span> <span class="o">=</span> <span class="nx">EL</span><span class="p">.</span><span class="nx">Text</span>
<span class="nx">End</span> <span class="nb">Function</span>

<span class="o">%&gt;</span>
</pre></table></code></div></div><h2 id="vba-code-for-sha-512-hash-using-mscorlibdll">VBA Code for SHA-512 hash using mscorlib.dll</h2><div class="language-js highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="dl">'</span><span class="s1">source - http://amadiere.com/blog/category/programming/classic-asp-programming/

Function Hash(strPassword, strIndividualSalt)

  Const strSiteWideSalt = "THIS IS A SITE WIDE SALT, BUT COULD BE A GUID"
  Hash = HashSHA512Managed(strSiteWideSalt &amp; strPassword &amp; strIndividualSalt)

End Function

Function HashSHA512Managed(saltedPassword)

  Dim objMD5, objUTF8
  Dim arrByte
  Dim strHash
  Set objUnicode = CreateObject("System.Text.UnicodeEncoding")
  Set objSHA512 = Server.CreateObject("System.Security.Cryptography.SHA512Managed")

  arrByte = objUnicode.GetBytes_4(saltedPassword)
  strHash = objSHA512.ComputeHash_2((arrByte))

  HashSHA512Managed = ToBase64String(strHash)

End Function

Function ToBase64String(rabyt)
  </span><span class="dl">'</span><span class="nx">tested</span><span class="o">&amp;</span><span class="nx">working</span>
  <span class="dl">'</span><span class="s1">Ref: http://stackoverflow.com/questions/1118947/converting-binary-file-to-base64-string
  Dim xml: Set xml = CreateObject("MSXML2.DOMDocument.3.0")
  xml.LoadXml "&lt;root&gt;&lt;/root&gt;"
  xml.documentElement.dataType = "bin.base64"
  xml.documentElement.nodeTypedValue = rabyt
  ToBase64String = Replace(xml.documentElement.Text,VbLf, "")

End Function
</span></pre></table></code></div></div><div class="language-js highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre><td class="rouge-code"><pre><span class="dl">'</span><span class="s1">source https://gist.github.com/jermity/b81622a2b10449c6be99

64-bit MS Access VBA code to calculate an SHA-512 or SHA-256 hash in VBA.  This requires a VBA reference to the .Net Framework 4.0 mscorlib.dll.  The hashed strings are calculated using calls to encryption methods built into mscorlib.dll.  The calculated hash strings are the same values as those calculated with jsSHA, a Javascript SHA implementation (see https://caligatio.github.io/jsSHA/ for an online calculator and the jsSHA code).

The mscorlib.dll is intended for .Net Framework managed applications, but the stackoverflow.com post showed how it could be used with MS Access VBA.  This technique is not documented anywhere in MS Access documentation that I could find, so the stackoverflow.com post was very helpful in this regard.  

Public Sub to_SHA512()
</span><span class="dl">'</span><span class="nx">Requires</span> <span class="nx">a</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="nx">mscorlib</span> <span class="mf">4.0</span> <span class="mi">64</span><span class="o">-</span><span class="nx">bit</span>
<span class="nx">Dim</span> <span class="nx">text</span> <span class="nx">As</span> <span class="nb">Object</span>
<span class="nx">Dim</span> <span class="nx">SHA512</span> <span class="nx">As</span> <span class="nb">Object</span>

<span class="nb">Set</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">CreateObject</span><span class="p">(</span><span class="dl">"</span><span class="s2">System.Text.UTF8Encoding</span><span class="dl">"</span><span class="p">)</span>
<span class="nb">Set</span> <span class="nx">SHA512</span> <span class="o">=</span> <span class="nx">CreateObject</span><span class="p">(</span><span class="dl">"</span><span class="s2">System.Security.Cryptography.SHA512Managed</span><span class="dl">"</span><span class="p">)</span>
<span class="nb">Set</span> <span class="nx">SHA256</span> <span class="o">=</span> <span class="nx">CreateObject</span><span class="p">(</span><span class="dl">"</span><span class="s2">System.Security.Cryptography.SHA256Managed</span><span class="dl">"</span><span class="p">)</span>
<span class="dl">'</span><span class="s1">Debug.Print ToBase64String(SHA512.ComputeHash_2((text.GetBytes_4("mypassword"))))
Debug.Print ToHexString(SHA512.ComputeHash_2((text.GetBytes_4("mypassword"))))
End Sub

Public Sub to_SHA256()
</span><span class="dl">'</span><span class="nx">Requires</span> <span class="nx">a</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="nx">mscorlib</span> <span class="mf">4.0</span> <span class="mi">64</span><span class="o">-</span><span class="nx">bit</span><span class="p">,</span> <span class="nx">which</span> <span class="nx">is</span> <span class="nx">part</span> <span class="k">of</span> <span class="nx">the</span> <span class="p">.</span><span class="nx">Net</span> <span class="nx">Framework</span> <span class="mf">4.0</span>
<span class="nx">Dim</span> <span class="nx">text</span> <span class="nx">As</span> <span class="nb">Object</span>
<span class="nx">Dim</span> <span class="nx">SHA256</span> <span class="nx">As</span> <span class="nb">Object</span>

<span class="nb">Set</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">CreateObject</span><span class="p">(</span><span class="dl">"</span><span class="s2">System.Text.UTF8Encoding</span><span class="dl">"</span><span class="p">)</span>
<span class="nb">Set</span> <span class="nx">SHA256</span> <span class="o">=</span> <span class="nx">CreateObject</span><span class="p">(</span><span class="dl">"</span><span class="s2">System.Security.Cryptography.SHA256Managed</span><span class="dl">"</span><span class="p">)</span>
<span class="nx">debug</span><span class="p">.</span><span class="nx">print</span> <span class="nx">ToHexString</span><span class="p">(</span><span class="nx">SHA256</span><span class="p">.</span><span class="nx">ComputeHash_2</span><span class="p">((</span><span class="nx">text</span><span class="p">.</span><span class="nx">GetBytes_4</span><span class="p">(</span><span class="dl">"</span><span class="s2">mypassword</span><span class="dl">"</span><span class="p">))))</span> 
<span class="nx">End</span> <span class="nx">Sub</span>

<span class="nb">Function</span> <span class="nx">ToBase64String</span><span class="p">(</span><span class="nx">rabyt</span><span class="p">)</span>

  <span class="dl">'</span><span class="s1">Ref: http://stackoverflow.com/questions/1118947/converting-binary-file-to-base64-string
  With CreateObject("MSXML2.DOMDocument")
    .LoadXML "&lt;root&gt;&lt;/root&gt;"
    .DocumentElement.DataType = "bin.base64"
    .DocumentElement.nodeTypedValue = rabyt
    ToBase64String = Replace(.DocumentElement.text, vbLf, "")
  End With
End Function

Function ToHexString(rabyt)

  </span><span class="dl">'</span><span class="nx">Ref</span><span class="p">:</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//stackoverflow.com/questions/1118947/converting-binary-file-to-base64-string</span>
  <span class="nx">With</span> <span class="nx">CreateObject</span><span class="p">(</span><span class="dl">"</span><span class="s2">MSXML2.DOMDocument</span><span class="dl">"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">LoadXML</span> <span class="dl">"</span><span class="s2">&lt;root&gt;&lt;/root&gt;</span><span class="dl">"</span>
    <span class="p">.</span><span class="nx">DocumentElement</span><span class="p">.</span><span class="nx">DataType</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">bin.Hex</span><span class="dl">"</span>
    <span class="p">.</span><span class="nx">DocumentElement</span><span class="p">.</span><span class="nx">nodeTypedValue</span> <span class="o">=</span> <span class="nx">rabyt</span>
    <span class="nx">ToHexString</span> <span class="o">=</span> <span class="nx">Replace</span><span class="p">(.</span><span class="nx">DocumentElement</span><span class="p">.</span><span class="nx">text</span><span class="p">,</span> <span class="nx">vbLf</span><span class="p">,</span> <span class="dl">""</span><span class="p">)</span>
  <span class="nx">End</span> <span class="nx">With</span>
<span class="nx">End</span> <span class="nb">Function</span>
</pre></table></code></div></div><h2 id="vbscript-readwrite-binary-encodedecode-base64">VBScript read/write binary, encode/decode Base64</h2><div class="language-js highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
</pre><td class="rouge-code"><pre><span class="dl">'</span><span class="s1">https://ghads.wordpress.com/2008/10/17/vbscript-readwrite-binary-encodedecode-base64/
</span><span class="dl">'</span>
<span class="dl">'</span><span class="s1"> Call via cmd: cscript ReadFileEncodeBase64DecodeBase64WriteFile.vbs [pathToFile]
</span><span class="dl">'</span>
<span class="dl">'</span><span class="s1"> - Reads file from arg into byte array
</span><span class="dl">'</span> <span class="o">-</span> <span class="nx">Encodes</span> <span class="nx">byte</span> <span class="nx">array</span> <span class="nx">to</span> <span class="nx">Base64</span> <span class="nb">String</span>
<span class="dl">'</span><span class="s1"> - Decodes Base64 String to byte array
</span><span class="dl">'</span> <span class="o">-</span> <span class="nx">Writes</span> <span class="nx">byte</span> <span class="nx">array</span> <span class="nx">to</span> <span class="k">new</span> <span class="nx">file</span>
<span class="dl">'</span><span class="s1">
</span><span class="dl">'</span> <span class="nx">Sample</span> <span class="nx">WITHOUT</span> <span class="nx">any</span> <span class="nx">warrenty</span><span class="o">!</span> <span class="nx">Use</span> <span class="nx">at</span> <span class="nx">own</span> <span class="nx">risk</span><span class="o">!</span> <span class="nx">Copyright</span> <span class="mi">2008</span> <span class="nx">Gerhard</span> <span class="nx">Balthasar</span>
<span class="dl">'</span><span class="s1">

Option Explicit
</span><span class="dl">'</span> <span class="nx">common</span> <span class="nx">consts</span>
<span class="nx">Const</span> <span class="nx">TypeBinary</span> <span class="o">=</span> <span class="mi">1</span>
<span class="nx">Const</span> <span class="nx">ForReading</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">ForWriting</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">ForAppending</span> <span class="o">=</span> <span class="mi">8</span>

<span class="dl">'</span><span class="s1"> getting file from args (no checks!)
Dim arguments, inFile, outFile

Set arguments = WScript.Arguments
inFile = arguments(0)
outFile = "new_" &amp; inFile

Dim inByteArray, base64Encoded, base64Decoded, outByteArray

inByteArray = readBytes(inFile)
base64Encoded = encodeBase64(inByteArray)

Wscript.echo "Base64 encoded: " + base64Encoded

base64Decoded = decodeBase64(base64Encoded)
writeBytes outFile, base64Decoded

Wscript.echo "Finished!"

private function readBytes(file)
  dim inStream
  </span><span class="dl">'</span> <span class="nx">ADODB</span> <span class="nx">stream</span> <span class="nx">object</span> <span class="nx">used</span>
  <span class="kd">set</span> <span class="nx">inStream</span> <span class="o">=</span> <span class="nx">WScript</span><span class="p">.</span><span class="nx">CreateObject</span><span class="p">(</span><span class="dl">"</span><span class="s2">ADODB.Stream</span><span class="dl">"</span><span class="p">)</span>
  <span class="dl">'</span><span class="s1"> open with no arguments makes the stream an empty container 
  inStream.Open
  inStream.type= TypeBinary
  inStream.LoadFromFile(file)
  readBytes = inStream.Read()
end function

private function encodeBase64(bytes)
  dim DM, EL
  Set DM = CreateObject("Microsoft.XMLDOM")
  </span><span class="dl">'</span> <span class="nx">Create</span> <span class="nx">temporary</span> <span class="nx">node</span> <span class="kd">with</span> <span class="nx">Base64</span> <span class="nx">data</span> <span class="nx">type</span>
  <span class="nb">Set</span> <span class="nx">EL</span> <span class="o">=</span> <span class="nx">DM</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">"</span><span class="s2">tmp</span><span class="dl">"</span><span class="p">)</span>
  <span class="nx">EL</span><span class="p">.</span><span class="nx">DataType</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">bin.base64</span><span class="dl">"</span>
  <span class="dl">'</span><span class="s1"> Set bytes, get encoded String
  EL.NodeTypedValue = bytes
  encodeBase64 = EL.Text
end function

private function decodeBase64(base64)
  dim DM, EL
  Set DM = CreateObject("Microsoft.XMLDOM")
  </span><span class="dl">'</span> <span class="nx">Create</span> <span class="nx">temporary</span> <span class="nx">node</span> <span class="kd">with</span> <span class="nx">Base64</span> <span class="nx">data</span> <span class="nx">type</span>
  <span class="nb">Set</span> <span class="nx">EL</span> <span class="o">=</span> <span class="nx">DM</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">"</span><span class="s2">tmp</span><span class="dl">"</span><span class="p">)</span>
  <span class="nx">EL</span><span class="p">.</span><span class="nx">DataType</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">bin.base64</span><span class="dl">"</span>
  <span class="dl">'</span><span class="s1"> Set encoded String, get bytes
  EL.Text = base64
  decodeBase64 = EL.NodeTypedValue
end function

private Sub writeBytes(file, bytes)
  Dim binaryStream
  Set binaryStream = CreateObject("ADODB.Stream")
  binaryStream.Type = TypeBinary
  </span><span class="dl">'</span><span class="nx">Open</span> <span class="nx">the</span> <span class="nx">stream</span> <span class="nx">and</span> <span class="nx">write</span> <span class="nx">binary</span> <span class="nx">data</span>
  <span class="nx">binaryStream</span><span class="p">.</span><span class="nx">Open</span>
  <span class="nx">binaryStream</span><span class="p">.</span><span class="nx">Write</span> <span class="nx">bytes</span>
  <span class="dl">'</span><span class="s1">Save binary data to disk
  binaryStream.SaveToFile file, ForWriting
End Sub
</span></pre></table></code></div></div><h2 id="replicating-phps-sha1-in-vbscript">Replicating PHPâ€™s sha1() in VBScript</h2><p><a href="https://angrytechnician.wordpress.com/2011/02/11/replicating-phps-sha1-in-vbscript/">https://angrytechnician.wordpress.com/2011/02/11/replicating-phps-sha1-in-vbscript/</a></p><div class="language-js highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="nx">Option</span> <span class="nx">Explicit</span>

<span class="nx">Dim</span> <span class="nx">asc</span><span class="p">,</span> <span class="nx">enc</span><span class="p">,</span> <span class="nx">bytes</span><span class="p">,</span> <span class="nx">instr</span><span class="p">,</span> <span class="nx">outstr</span><span class="p">,</span> <span class="nx">pos</span>

<span class="nx">instr</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">test string</span><span class="dl">"</span>

<span class="dl">'</span><span class="s1">Borrow some objects from .NET (supported from 1.1 onwards)
Set asc = CreateObject("System.Text.UTF8Encoding")
Set enc = CreateObject("System.Security.Cryptography.SHA1CryptoServiceProvider")

</span><span class="dl">'</span><span class="nx">Convert</span> <span class="nx">the</span> <span class="nx">string</span> <span class="nx">to</span> <span class="nx">a</span> <span class="nx">byte</span> <span class="nx">array</span> <span class="nx">and</span> <span class="nx">hash</span> <span class="nx">it</span>
<span class="nx">bytes</span> <span class="o">=</span> <span class="nx">asc</span><span class="p">.</span><span class="nx">GetBytes_4</span><span class="p">(</span><span class="nx">instr</span><span class="p">)</span>
<span class="nx">bytes</span> <span class="o">=</span> <span class="nx">enc</span><span class="p">.</span><span class="nx">ComputeHash_2</span><span class="p">((</span><span class="nx">bytes</span><span class="p">))</span>

<span class="nx">outstr</span> <span class="o">=</span> <span class="dl">""</span>

<span class="dl">'</span><span class="s1">Convert the byte array to a hex string
For pos = 1 To Lenb(bytes)
 outstr = outstr &amp; LCase(Right("0" &amp; Hex(Ascb(Midb(bytes, pos, 1))), 2))
Next

WScript.Echo outstr
</span></pre></table></code></div></div><p>origin - http://www.pipiscrew.com/?p=2338 aspvbs-sha-hash-tobase64string</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/php/'>php</a>, <a href='/categories/asp-classic/'>asp_classic</a>, <a href='/categories/vba/'>vba</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=SHA hash + ToBase64String - PipisCrew&url=/posts/sha-hash-t/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=SHA hash + ToBase64String - PipisCrew&u=/posts/sha-hash-t/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=SHA hash + ToBase64String - PipisCrew&url=/posts/sha-hash-t/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/create-a-d/"><div class="card-body"> <span class="timeago small" > Apr 24 <i class="unloaded">2020-04-24T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Create a DLL by CSharp or VB.Net for VBA/VB6</h3><div class="text-muted small"><p> http://www.geeksengine.com/article/create-dll.html (mirror) http://www.codeproject.com/Articles/16310/How-to-Automate-Exporting-NET-Function-to-Unmanage #interop #com origin - http://www.pipiscr...</p></div></div></a></div><div class="card"> <a href="/posts/proper-con/"><div class="card-body"> <span class="timeago small" > Jun 23, 2017 <i class="unloaded">2017-06-23T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Proper convert UTC to Browser time</h3><div class="text-muted small"><p> //src - //https://stackoverflow.com/a/13622393/1320686 ////try 01 //when is Daylight saving time (DST) *NOT* applied var dateStr = '11/30/2016 3:05:24 AM UTC'; var date = new Date(dateStr); conso...</p></div></div></a></div><div class="card"> <a href="/posts/php-androi/"><div class="card-body"> <span class="timeago small" > Jun 24, 2017 <i class="unloaded">2017-06-24T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>o[php android .net] Encryption - AES128 PKCS7</h3><div class="text-muted small"><p> references : http://aesencryption.net/ https://zenu.wordpress.com/2011/09/21/aes-128bit-cross-platform-java-and-c-encryption-compatibility/ https://gist.github.com/jafetsanchez/1080133 http://vivav...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/over-a-thi/" class="btn btn-outline-primary"><p>Over a third of online Black Friday purchases came from phones</p></a> <a href="/posts/vitevicass/" class="btn btn-outline-primary"><p>Vitevic.Assembly Embedder</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> Â© 2020 <a href="https://twitter.com/pipiscrew">pipiscrew</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
