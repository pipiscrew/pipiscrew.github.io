<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.6.2"><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="generate scripts + alternative" /><meta name="author" content="PipisCrew" /><meta property="og:locale" content="en_US" /><meta name="description" content="http://stackoverflow.com/a/1515975 In SSMS in the Object Explorer, right click on the database right-click and pick “Tasks” and then “Generate Scripts”." /><meta property="og:description" content="http://stackoverflow.com/a/1515975 In SSMS in the Object Explorer, right click on the database right-click and pick “Tasks” and then “Generate Scripts”." /><link rel="canonical" href="/posts/generate-s/" /><meta property="og:url" content="/posts/generate-s/" /><meta property="og:site_name" content="PipisCrew" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2015-12-11T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="generate scripts + alternative" /><meta name="twitter:site" content="@pipiscrew" /><meta name="twitter:creator" content="@PipisCrew" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@type":"BlogPosting","url":"/posts/generate-s/","headline":"generate scripts + alternative","dateModified":"2015-12-11T00:00:00+08:00","datePublished":"2015-12-11T00:00:00+08:00","author":{"@type":"Person","name":"PipisCrew"},"mainEntityOfPage":{"@type":"WebPage","@id":"/posts/generate-s/"},"description":"http://stackoverflow.com/a/1515975 In SSMS in the Object Explorer, right click on the database right-click and pick “Tasks” and then “Generate Scripts”.","@context":"https://schema.org"}</script><title>generate scripts + alternative | PipisCrew</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">PipisCrew</a></div><div class="site-subtitle font-italic">A text-focused Jekyll theme.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/pipiscrew" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/pipiscrew" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>generate scripts + alternative</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>generate scripts + alternative</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Dec 11, 2015, 12:00 AM +0800" > Dec 11, 2015 <i class="unloaded">2015-12-11T00:00:00+08:00</i> </span> by <span class="author"> PipisCrew </span></div></div><div class="post-content"><p><a href="http://stackoverflow.com/a/1515975">http://stackoverflow.com/a/1515975</a> In SSMS in the Object Explorer, right click on the database right-click and pick “Tasks” and then “Generate Scripts”.</p><hr /><h3 id="method-1">Method 1</h3><p>For example, it lets you do this: To generate INSERT statements for table ‘titles’:</p><div class="language-js highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">//http://stackoverflow.com/a/982587</span>
<span class="nx">EXEC</span> <span class="nx">sp_generate_inserts</span> <span class="dl">'</span><span class="s1">titles</span><span class="dl">'</span>
</pre></table></code></div></div><div class="language-js highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
</pre><td class="rouge-code"><pre><span class="o">--</span><span class="nx">source</span> <span class="p">:</span>
<span class="o">--</span><span class="nx">http</span><span class="p">:</span><span class="c1">//vyaskn.tripod.com/code.htm#inserts</span>
<span class="o">--</span><span class="nx">http</span><span class="p">:</span><span class="c1">//vyaskn.tripod.com/code/generate_inserts_2005.txt</span>
<span class="nx">SET</span> <span class="nx">NOCOUNT</span> <span class="nx">ON</span>
<span class="nx">GO</span>

<span class="nx">PRINT</span> <span class="dl">'</span><span class="s1">Using Master database</span><span class="dl">'</span>
<span class="nx">USE</span> <span class="nx">master</span>
<span class="nx">GO</span>

<span class="nx">PRINT</span> <span class="dl">'</span><span class="s1">Checking for the existence of this procedure</span><span class="dl">'</span>
<span class="nx">IF</span> <span class="p">(</span><span class="nx">SELECT</span> <span class="nx">OBJECT_ID</span><span class="p">(</span><span class="dl">'</span><span class="s1">sp_generate_inserts</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">P</span><span class="dl">'</span><span class="p">))</span> <span class="nx">IS</span> <span class="nx">NOT</span> <span class="nx">NULL</span> <span class="o">--</span><span class="nx">means</span><span class="p">,</span> <span class="nx">the</span> <span class="nx">procedure</span> <span class="nx">already</span> <span class="nx">exists</span>
	<span class="nx">BEGIN</span>
		<span class="nx">PRINT</span> <span class="dl">'</span><span class="s1">Procedure already exists. So, dropping it</span><span class="dl">'</span>
		<span class="nx">DROP</span> <span class="nx">PROC</span> <span class="nx">sp_generate_inserts</span>
	<span class="nx">END</span>
<span class="nx">GO</span>

<span class="nx">CREATE</span> <span class="nx">PROC</span> <span class="nx">sp_generate_inserts</span>
<span class="p">(</span>
	<span class="p">@</span><span class="nd">table_name</span> <span class="nx">varchar</span><span class="p">(</span><span class="mi">776</span><span class="p">),</span>  		<span class="o">--</span> <span class="nx">The</span> <span class="nx">table</span><span class="o">/</span><span class="nx">view</span> <span class="k">for</span> <span class="nx">which</span> <span class="nx">the</span> <span class="nx">INSERT</span> <span class="nx">statements</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">generated</span> <span class="nx">using</span> <span class="nx">the</span> <span class="nx">existing</span> <span class="nx">data</span>
	<span class="p">@</span><span class="nd">target_table</span> <span class="nx">varchar</span><span class="p">(</span><span class="mi">776</span><span class="p">)</span> <span class="o">=</span> <span class="nx">NULL</span><span class="p">,</span> 	<span class="o">--</span> <span class="nx">Use</span> <span class="k">this</span> <span class="nx">parameter</span> <span class="nx">to</span> <span class="nx">specify</span> <span class="nx">a</span> <span class="nx">different</span> <span class="nx">table</span> <span class="nx">name</span> <span class="nx">into</span> <span class="nx">which</span> <span class="nx">the</span> <span class="nx">data</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">inserted</span>
	<span class="p">@</span><span class="nd">include_column_list</span> <span class="nx">bit</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>		<span class="o">--</span> <span class="nx">Use</span> <span class="k">this</span> <span class="nx">parameter</span> <span class="nx">to</span> <span class="nx">include</span><span class="o">/</span><span class="nx">ommit</span> <span class="nx">column</span> <span class="nx">list</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">generated</span> <span class="nx">INSERT</span> <span class="nx">statement</span>
	<span class="p">@</span><span class="nd">from</span> <span class="nx">varchar</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span> <span class="o">=</span> <span class="nx">NULL</span><span class="p">,</span> 		<span class="o">--</span> <span class="nx">Use</span> <span class="k">this</span> <span class="nx">parameter</span> <span class="nx">to</span> <span class="nx">filter</span> <span class="nx">the</span> <span class="nx">rows</span> <span class="nx">based</span> <span class="nx">on</span> <span class="nx">a</span> <span class="nx">filter</span> <span class="nx">condition</span> <span class="p">(</span><span class="nx">using</span> <span class="nx">WHERE</span><span class="p">)</span>
	<span class="p">@</span><span class="nd">include_timestamp</span> <span class="nx">bit</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 		<span class="o">--</span> <span class="nx">Specify</span> <span class="mi">1</span> <span class="k">for</span> <span class="k">this</span> <span class="nx">parameter</span><span class="p">,</span> <span class="k">if</span> <span class="nx">you</span> <span class="nx">want</span> <span class="nx">to</span> <span class="nx">include</span> <span class="nx">the</span> <span class="nx">TIMESTAMP</span><span class="o">/</span><span class="nx">ROWVERSION</span> <span class="nx">column</span><span class="dl">'</span><span class="s1">s data in the INSERT statement
	@debug_mode bit = 0,			-- If @debug_mode is set to 1, the SQL statements constructed by this procedure will be printed for later examination
	@owner varchar(64) = NULL,		-- Use this parameter if you are not the owner of the table
	@ommit_images bit = 0,			-- Use this parameter to generate INSERT statements by omitting the </span><span class="dl">'</span><span class="nx">image</span><span class="dl">'</span><span class="s1"> columns
	@ommit_identity bit = 0,		-- Use this parameter to ommit the identity columns
	@top int = NULL,			-- Use this parameter to generate INSERT statements only for the TOP n rows
	@cols_to_include varchar(8000) = NULL,	-- List of columns to be included in the INSERT statement
	@cols_to_exclude varchar(8000) = NULL,	-- List of columns to be excluded from the INSERT statement
	@disable_constraints bit = 0,		-- When 1, disables foreign key constraints and enables them after the INSERT statements
	@ommit_computed_cols bit = 0		-- When 1, computed columns will not be included in the INSERT statement

)
AS
BEGIN

/***********************************************************************************************************
Procedure:	sp_generate_inserts  (Build 22) 
		(Copyright © 2002 Narayana Vyas Kondreddi. All rights reserved.)

Purpose:	To generate INSERT statements from existing data. 
		These INSERTS can be executed to regenerate the data at some other location.
		This procedure is also useful to create a database setup, where in you can 
		script your data along with your table definitions.

Written by:	Narayana Vyas Kondreddi
	        http://vyaskn.tripod.com

Acknowledgements:
		Divya Kalra	-- For beta testing
		Mark Charsley	-- For reporting a problem with scripting uniqueidentifier columns with NULL values
		Artur Zeygman	-- For helping me simplify a bit of code for handling non-dbo owned tables
		Joris Laperre   -- For reporting a regression bug in handling text/ntext columns

Tested on: 	SQL Server 7.0 and SQL Server 2000 and SQL Server 2005

Date created:	January 17th 2001 21:52 GMT

Date modified:	May 1st 2002 19:50 GMT

Email: 		vyaskn@hotmail.com

NOTE:		This procedure may not work with tables with too many columns.
		Results can be unpredictable with huge text columns or SQL Server 2000</span><span class="dl">'</span><span class="nx">s</span> <span class="nx">sql_variant</span> <span class="nx">data</span> <span class="nx">types</span>
		<span class="nx">Whenever</span> <span class="nx">possible</span><span class="p">,</span> <span class="nx">Use</span> <span class="p">@</span><span class="nd">include_column_list</span> <span class="nx">parameter</span> <span class="nx">to</span> <span class="nx">ommit</span> <span class="nx">column</span> <span class="nx">list</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">INSERT</span> <span class="nx">statement</span><span class="p">,</span> <span class="k">for</span> <span class="nx">better</span> <span class="nx">results</span>
		<span class="nx">IMPORTANT</span><span class="p">:</span> <span class="nx">This</span> <span class="nx">procedure</span> <span class="nx">is</span> <span class="nx">not</span> <span class="nx">tested</span> <span class="kd">with</span> <span class="nx">internation</span> <span class="nx">data</span> <span class="p">(</span><span class="nx">Extended</span> <span class="nx">characters</span> <span class="nx">or</span> <span class="nx">Unicode</span><span class="p">).</span> <span class="nx">If</span> <span class="nx">needed</span>
		<span class="nx">you</span> <span class="nx">might</span> <span class="nx">want</span> <span class="nx">to</span> <span class="nx">convert</span> <span class="nx">the</span> <span class="nx">datatypes</span> <span class="k">of</span> <span class="nx">character</span> <span class="nx">variables</span> <span class="k">in</span> <span class="k">this</span> <span class="nx">procedure</span> <span class="nx">to</span> <span class="nx">their</span> <span class="nx">respective</span> <span class="nx">unicode</span> <span class="nx">counterparts</span>
		<span class="nx">like</span> <span class="nx">nchar</span> <span class="nx">and</span> <span class="nx">nvarchar</span>

		<span class="nx">ALSO</span> <span class="nx">NOTE</span> <span class="nx">THAT</span> <span class="nx">THIS</span> <span class="nx">PROCEDURE</span> <span class="nx">IS</span> <span class="nx">NOT</span> <span class="nx">UPDATED</span> <span class="nx">TO</span> <span class="nx">WORK</span> <span class="nx">WITH</span> <span class="nx">NEW</span> <span class="nx">DATA</span> <span class="nx">TYPES</span> <span class="nx">INTRODUCED</span> <span class="nx">IN</span> <span class="nx">SQL</span> <span class="nx">SERVER</span> <span class="mi">2005</span> <span class="o">/</span> <span class="nx">YUKON</span>

<span class="nx">Example</span> <span class="mi">1</span><span class="p">:</span>	<span class="nx">To</span> <span class="nx">generate</span> <span class="nx">INSERT</span> <span class="nx">statements</span> <span class="k">for</span> <span class="nx">table</span> <span class="dl">'</span><span class="s1">titles</span><span class="dl">'</span><span class="p">:</span>

		<span class="nx">EXEC</span> <span class="nx">sp_generate_inserts</span> <span class="dl">'</span><span class="s1">titles</span><span class="dl">'</span>

<span class="nx">Example</span> <span class="mi">2</span><span class="p">:</span> 	<span class="nx">To</span> <span class="nx">ommit</span> <span class="nx">the</span> <span class="nx">column</span> <span class="nx">list</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">INSERT</span> <span class="nx">statement</span><span class="p">:</span> <span class="p">(</span><span class="nx">Column</span> <span class="nx">list</span> <span class="nx">is</span> <span class="nx">included</span> <span class="nx">by</span> <span class="k">default</span><span class="p">)</span>
		<span class="nx">IMPORTANT</span><span class="p">:</span> <span class="nx">If</span> <span class="nx">you</span> <span class="nx">have</span> <span class="nx">too</span> <span class="nx">many</span> <span class="nx">columns</span><span class="p">,</span> <span class="nx">you</span> <span class="nx">are</span> <span class="nx">advised</span> <span class="nx">to</span> <span class="nx">ommit</span> <span class="nx">column</span> <span class="nx">list</span><span class="p">,</span> <span class="k">as</span> <span class="nx">shown</span> <span class="nx">below</span><span class="p">,</span>
		<span class="nx">to</span> <span class="nx">avoid</span> <span class="nx">erroneous</span> <span class="nx">results</span>

		<span class="nx">EXEC</span> <span class="nx">sp_generate_inserts</span> <span class="dl">'</span><span class="s1">titles</span><span class="dl">'</span><span class="p">,</span> <span class="p">@</span><span class="nd">include_column_list</span> <span class="o">=</span> <span class="mi">0</span>

<span class="nx">Example</span> <span class="mi">3</span><span class="p">:</span>	<span class="nx">To</span> <span class="nx">generate</span> <span class="nx">INSERT</span> <span class="nx">statements</span> <span class="k">for</span> <span class="dl">'</span><span class="s1">titlesCopy</span><span class="dl">'</span> <span class="nx">table</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">titles</span><span class="dl">'</span> <span class="nx">table</span><span class="p">:</span>

		<span class="nx">EXEC</span> <span class="nx">sp_generate_inserts</span> <span class="dl">'</span><span class="s1">titles</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">titlesCopy</span><span class="dl">'</span>

<span class="nx">Example</span> <span class="mi">4</span><span class="p">:</span>	<span class="nx">To</span> <span class="nx">generate</span> <span class="nx">INSERT</span> <span class="nx">statements</span> <span class="k">for</span> <span class="dl">'</span><span class="s1">titles</span><span class="dl">'</span> <span class="nx">table</span> <span class="k">for</span> <span class="nx">only</span> <span class="nx">those</span> <span class="nx">titles</span> 
		<span class="nx">which</span> <span class="nx">contain</span> <span class="nx">the</span> <span class="nx">word</span> <span class="dl">'</span><span class="s1">Computer</span><span class="dl">'</span> <span class="k">in</span> <span class="nx">them</span><span class="p">:</span>
		<span class="nx">NOTE</span><span class="p">:</span> <span class="nx">Do</span> <span class="nx">not</span> <span class="nx">complicate</span> <span class="nx">the</span> <span class="nx">FROM</span> <span class="nx">or</span> <span class="nx">WHERE</span> <span class="nx">clause</span> <span class="nx">here</span><span class="p">.</span> <span class="nx">It</span><span class="dl">'</span><span class="s1">s assumed that you are good with T-SQL if you are using this parameter

		EXEC sp_generate_inserts </span><span class="dl">'</span><span class="nx">titles</span><span class="dl">'</span><span class="s1">, @from = "from titles where title like </span><span class="dl">'</span><span class="o">%</span><span class="nx">Computer</span><span class="o">%</span><span class="dl">'</span><span class="s1">"

Example 5: 	To specify that you want to include TIMESTAMP column</span><span class="dl">'</span><span class="nx">s</span> <span class="nx">data</span> <span class="k">as</span> <span class="nx">well</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">INSERT</span> <span class="nx">statement</span><span class="p">:</span>
		<span class="p">(</span><span class="nx">By</span> <span class="k">default</span> <span class="nx">TIMESTAMP</span> <span class="nx">column</span><span class="dl">'</span><span class="s1">s data is not scripted)

		EXEC sp_generate_inserts </span><span class="dl">'</span><span class="nx">titles</span><span class="dl">'</span><span class="s1">, @include_timestamp = 1

Example 6:	To print the debug information:

		EXEC sp_generate_inserts </span><span class="dl">'</span><span class="nx">titles</span><span class="dl">'</span><span class="s1">, @debug_mode = 1

Example 7: 	If you are not the owner of the table, use @owner parameter to specify the owner name
		To use this option, you must have SELECT permissions on that table

		EXEC sp_generate_inserts Nickstable, @owner = </span><span class="dl">'</span><span class="nx">Nick</span><span class="dl">'</span><span class="s1">

Example 8: 	To generate INSERT statements for the rest of the columns excluding images
		When using this otion, DO NOT set @include_column_list parameter to 0.

		EXEC sp_generate_inserts imgtable, @ommit_images = 1

Example 9: 	To generate INSERT statements excluding (ommiting) IDENTITY columns:
		(By default IDENTITY columns are included in the INSERT statement)

		EXEC sp_generate_inserts mytable, @ommit_identity = 1

Example 10: 	To generate INSERT statements for the TOP 10 rows in the table:

		EXEC sp_generate_inserts mytable, @top = 10

Example 11: 	To generate INSERT statements with only those columns you want:

		EXEC sp_generate_inserts titles, @cols_to_include = "</span><span class="dl">'</span><span class="nx">title</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="nx">title_id</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="nx">au_id</span><span class="dl">'</span><span class="s1">"

Example 12: 	To generate INSERT statements by omitting certain columns:

		EXEC sp_generate_inserts titles, @cols_to_exclude = "</span><span class="dl">'</span><span class="nx">title</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="nx">title_id</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="nx">au_id</span><span class="dl">'</span><span class="s1">"

Example 13:	To avoid checking the foreign key constraints while loading data with INSERT statements:

		EXEC sp_generate_inserts titles, @disable_constraints = 1

Example 14: 	To exclude computed columns from the INSERT statement:
		EXEC sp_generate_inserts MyTable, @ommit_computed_cols = 1
***********************************************************************************************************/

SET NOCOUNT ON

--Making sure user only uses either @cols_to_include or @cols_to_exclude
IF ((@cols_to_include IS NOT NULL) AND (@cols_to_exclude IS NOT NULL))
	BEGIN
		RAISERROR(</span><span class="dl">'</span><span class="nx">Use</span> <span class="nx">either</span> <span class="p">@</span><span class="nd">cols_to_include</span> <span class="nx">or</span> <span class="p">@</span><span class="nd">cols_to_exclude</span><span class="p">.</span> <span class="nx">Do</span> <span class="nx">not</span> <span class="nx">use</span> <span class="nx">both</span> <span class="nx">the</span> <span class="nx">parameters</span> <span class="nx">at</span> <span class="nx">once</span><span class="dl">'</span><span class="s1">,16,1)
		RETURN -1 --Failure. Reason: Both @cols_to_include and @cols_to_exclude parameters are specified
	END

--Making sure the @cols_to_include and @cols_to_exclude parameters are receiving values in proper format
IF ((@cols_to_include IS NOT NULL) AND (PATINDEX(</span><span class="dl">'''</span><span class="o">%</span><span class="dl">'''</span><span class="s1">,@cols_to_include) = 0))
	BEGIN
		RAISERROR(</span><span class="dl">'</span><span class="nx">Invalid</span> <span class="nx">use</span> <span class="k">of</span> <span class="p">@</span><span class="nd">cols_to_include</span> <span class="nx">property</span><span class="dl">'</span><span class="s1">,16,1)
		PRINT </span><span class="dl">'</span><span class="nx">Specify</span> <span class="nx">column</span> <span class="nx">names</span> <span class="nx">surrounded</span> <span class="nx">by</span> <span class="nx">single</span> <span class="nx">quotes</span> <span class="nx">and</span> <span class="nx">separated</span> <span class="nx">by</span> <span class="nx">commas</span><span class="dl">'</span><span class="s1">
		PRINT </span><span class="dl">'</span><span class="nx">Eg</span><span class="p">:</span> <span class="nx">EXEC</span> <span class="nx">sp_generate_inserts</span> <span class="nx">titles</span><span class="p">,</span> <span class="p">@</span><span class="nd">cols_to_include</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">''title_id'',''title''</span><span class="dl">"'</span><span class="s1">
		RETURN -1 --Failure. Reason: Invalid use of @cols_to_include property
	END

IF ((@cols_to_exclude IS NOT NULL) AND (PATINDEX(</span><span class="dl">'''</span><span class="o">%</span><span class="dl">'''</span><span class="s1">,@cols_to_exclude) = 0))
	BEGIN
		RAISERROR(</span><span class="dl">'</span><span class="nx">Invalid</span> <span class="nx">use</span> <span class="k">of</span> <span class="p">@</span><span class="nd">cols_to_exclude</span> <span class="nx">property</span><span class="dl">'</span><span class="s1">,16,1)
		PRINT </span><span class="dl">'</span><span class="nx">Specify</span> <span class="nx">column</span> <span class="nx">names</span> <span class="nx">surrounded</span> <span class="nx">by</span> <span class="nx">single</span> <span class="nx">quotes</span> <span class="nx">and</span> <span class="nx">separated</span> <span class="nx">by</span> <span class="nx">commas</span><span class="dl">'</span><span class="s1">
		PRINT </span><span class="dl">'</span><span class="nx">Eg</span><span class="p">:</span> <span class="nx">EXEC</span> <span class="nx">sp_generate_inserts</span> <span class="nx">titles</span><span class="p">,</span> <span class="p">@</span><span class="nd">cols_to_exclude</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">''title_id'',''title''</span><span class="dl">"'</span><span class="s1">
		RETURN -1 --Failure. Reason: Invalid use of @cols_to_exclude property
	END

--Checking to see if the database name is specified along wih the table name
--Your database context should be local to the table for which you want to generate INSERT statements
--specifying the database name is not allowed
IF (PARSENAME(@table_name,3)) IS NOT NULL
	BEGIN
		RAISERROR(</span><span class="dl">'</span><span class="nx">Do</span> <span class="nx">not</span> <span class="nx">specify</span> <span class="nx">the</span> <span class="nx">database</span> <span class="nx">name</span><span class="p">.</span> <span class="nx">Be</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">required</span> <span class="nx">database</span> <span class="nx">and</span> <span class="nx">just</span> <span class="nx">specify</span> <span class="nx">the</span> <span class="nx">table</span> <span class="nx">name</span><span class="p">.</span><span class="dl">'</span><span class="s1">,16,1)
		RETURN -1 --Failure. Reason: Database name is specified along with the table name, which is not allowed
	END

--Checking for the existence of </span><span class="dl">'</span><span class="nx">user</span> <span class="nx">table</span><span class="dl">'</span><span class="s1"> or </span><span class="dl">'</span><span class="nx">view</span><span class="dl">'</span><span class="s1">
--This procedure is not written to work on system tables
--To script the data in system tables, just create a view on the system tables and script the view instead

IF @owner IS NULL
	BEGIN
		IF ((OBJECT_ID(@table_name,</span><span class="dl">'</span><span class="nx">U</span><span class="dl">'</span><span class="s1">) IS NULL) AND (OBJECT_ID(@table_name,</span><span class="dl">'</span><span class="nx">V</span><span class="dl">'</span><span class="s1">) IS NULL)) 
			BEGIN
				RAISERROR(</span><span class="dl">'</span><span class="nx">User</span> <span class="nx">table</span> <span class="nx">or</span> <span class="nx">view</span> <span class="nx">not</span> <span class="nx">found</span><span class="p">.</span><span class="dl">'</span><span class="s1">,16,1)
				PRINT </span><span class="dl">'</span><span class="nx">You</span> <span class="nx">may</span> <span class="nx">see</span> <span class="k">this</span> <span class="nx">error</span><span class="p">,</span> <span class="k">if</span> <span class="nx">you</span> <span class="nx">are</span> <span class="nx">not</span> <span class="nx">the</span> <span class="nx">owner</span> <span class="k">of</span> <span class="k">this</span> <span class="nx">table</span> <span class="nx">or</span> <span class="nx">view</span><span class="p">.</span> <span class="nx">In</span> <span class="nx">that</span> <span class="k">case</span> <span class="nx">use</span> <span class="p">@</span><span class="nd">owner</span> <span class="nx">parameter</span> <span class="nx">to</span> <span class="nx">specify</span> <span class="nx">the</span> <span class="nx">owner</span> <span class="nx">name</span><span class="p">.</span><span class="dl">'</span><span class="s1">
				PRINT </span><span class="dl">'</span><span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> <span class="nx">have</span> <span class="nx">SELECT</span> <span class="nx">permission</span> <span class="nx">on</span> <span class="nx">that</span> <span class="nx">table</span> <span class="nx">or</span> <span class="nx">view</span><span class="p">.</span><span class="dl">'</span><span class="s1">
				RETURN -1 --Failure. Reason: There is no user table or view with this name
			END
	END
ELSE
	BEGIN
		IF NOT EXISTS (SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = @table_name AND (TABLE_TYPE = </span><span class="dl">'</span><span class="nx">BASE</span> <span class="nx">TABLE</span><span class="dl">'</span><span class="s1"> OR TABLE_TYPE = </span><span class="dl">'</span><span class="nx">VIEW</span><span class="dl">'</span><span class="s1">) AND TABLE_SCHEMA = @owner)
			BEGIN
				RAISERROR(</span><span class="dl">'</span><span class="nx">User</span> <span class="nx">table</span> <span class="nx">or</span> <span class="nx">view</span> <span class="nx">not</span> <span class="nx">found</span><span class="p">.</span><span class="dl">'</span><span class="s1">,16,1)
				PRINT </span><span class="dl">'</span><span class="nx">You</span> <span class="nx">may</span> <span class="nx">see</span> <span class="k">this</span> <span class="nx">error</span><span class="p">,</span> <span class="k">if</span> <span class="nx">you</span> <span class="nx">are</span> <span class="nx">not</span> <span class="nx">the</span> <span class="nx">owner</span> <span class="k">of</span> <span class="k">this</span> <span class="nx">table</span><span class="p">.</span> <span class="nx">In</span> <span class="nx">that</span> <span class="k">case</span> <span class="nx">use</span> <span class="p">@</span><span class="nd">owner</span> <span class="nx">parameter</span> <span class="nx">to</span> <span class="nx">specify</span> <span class="nx">the</span> <span class="nx">owner</span> <span class="nx">name</span><span class="p">.</span><span class="dl">'</span><span class="s1">
				PRINT </span><span class="dl">'</span><span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> <span class="nx">have</span> <span class="nx">SELECT</span> <span class="nx">permission</span> <span class="nx">on</span> <span class="nx">that</span> <span class="nx">table</span> <span class="nx">or</span> <span class="nx">view</span><span class="p">.</span><span class="dl">'</span><span class="s1">
				RETURN -1 --Failure. Reason: There is no user table or view with this name		
			END
	END

--Variable declarations
DECLARE		@Column_ID int, 		
		@Column_List varchar(8000), 
		@Column_Name varchar(128), 
		@Start_Insert varchar(786), 
		@Data_Type varchar(128), 
		@Actual_Values varchar(8000),	--This is the string that will be finally executed to generate INSERT statements
		@IDN varchar(128)		--Will contain the IDENTITY column</span><span class="dl">'</span><span class="nx">s</span> <span class="nx">name</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">table</span>

<span class="o">--</span><span class="nx">Variable</span> <span class="nx">Initialization</span>
<span class="nx">SET</span> <span class="p">@</span><span class="nd">IDN</span> <span class="o">=</span> <span class="dl">''</span>
<span class="nx">SET</span> <span class="p">@</span><span class="nd">Column_ID</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nx">SET</span> <span class="p">@</span><span class="nd">Column_Name</span> <span class="o">=</span> <span class="dl">''</span>
<span class="nx">SET</span> <span class="p">@</span><span class="nd">Column_List</span> <span class="o">=</span> <span class="dl">''</span>
<span class="nx">SET</span> <span class="p">@</span><span class="nd">Actual_Values</span> <span class="o">=</span> <span class="dl">''</span>

<span class="nx">IF</span> <span class="p">@</span><span class="nd">owner</span> <span class="nx">IS</span> <span class="nx">NULL</span> 
	<span class="nx">BEGIN</span>
		<span class="nx">SET</span> <span class="p">@</span><span class="nd">Start_Insert</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">INSERT INTO </span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">[</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">RTRIM</span><span class="p">(</span><span class="nx">COALESCE</span><span class="p">(@</span><span class="nd">target_table</span><span class="p">,@</span><span class="nd">table_name</span><span class="p">))</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">]</span><span class="dl">'</span> 
	<span class="nx">END</span>
<span class="nx">ELSE</span>
	<span class="nx">BEGIN</span>
		<span class="nx">SET</span> <span class="p">@</span><span class="nd">Start_Insert</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">INSERT </span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">[</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">LTRIM</span><span class="p">(</span><span class="nx">RTRIM</span><span class="p">(@</span><span class="nd">owner</span><span class="p">))</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">].</span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">[</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">RTRIM</span><span class="p">(</span><span class="nx">COALESCE</span><span class="p">(@</span><span class="nd">target_table</span><span class="p">,@</span><span class="nd">table_name</span><span class="p">))</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">]</span><span class="dl">'</span> 		
	<span class="nx">END</span>

<span class="o">--</span><span class="nx">To</span> <span class="kd">get</span> <span class="nx">the</span> <span class="nx">first</span> <span class="nx">column</span><span class="dl">'</span><span class="s1">s ID

SELECT	@Column_ID = MIN(ORDINAL_POSITION) 	
FROM	INFORMATION_SCHEMA.COLUMNS (NOLOCK) 
WHERE 	TABLE_NAME = @table_name AND
(@owner IS NULL OR TABLE_SCHEMA = @owner)

--Loop through all the columns of the table, to get the column names and their data types
WHILE @Column_ID IS NOT NULL
	BEGIN
		SELECT 	@Column_Name = QUOTENAME(COLUMN_NAME), 
		@Data_Type = DATA_TYPE 
		FROM 	INFORMATION_SCHEMA.COLUMNS (NOLOCK) 
		WHERE 	ORDINAL_POSITION = @Column_ID AND 
		TABLE_NAME = @table_name AND
		(@owner IS NULL OR TABLE_SCHEMA = @owner)

		IF @cols_to_include IS NOT NULL --Selecting only user specified columns
		BEGIN
			IF CHARINDEX( </span><span class="dl">''''</span><span class="s1"> + SUBSTRING(@Column_Name,2,LEN(@Column_Name)-2) + </span><span class="dl">''''</span><span class="s1">,@cols_to_include) = 0 
			BEGIN
				GOTO SKIP_LOOP
			END
		END

		IF @cols_to_exclude IS NOT NULL --Selecting only user specified columns
		BEGIN
			IF CHARINDEX( </span><span class="dl">''''</span><span class="s1"> + SUBSTRING(@Column_Name,2,LEN(@Column_Name)-2) + </span><span class="dl">''''</span><span class="s1">,@cols_to_exclude) &lt;&gt; 0 
			BEGIN
				GOTO SKIP_LOOP
			END
		END

		--Making sure to output SET IDENTITY_INSERT ON/OFF in case the table has an IDENTITY column
		IF (SELECT COLUMNPROPERTY( OBJECT_ID(QUOTENAME(COALESCE(@owner,USER_NAME())) + </span><span class="dl">'</span><span class="p">.</span><span class="dl">'</span><span class="s1"> + @table_name),SUBSTRING(@Column_Name,2,LEN(@Column_Name) - 2),</span><span class="dl">'</span><span class="nx">IsIdentity</span><span class="dl">'</span><span class="s1">)) = 1 
		BEGIN
			IF @ommit_identity = 0 --Determing whether to include or exclude the IDENTITY column
				SET @IDN = @Column_Name
			ELSE
				GOTO SKIP_LOOP			
		END

		--Making sure whether to output computed columns or not
		IF @ommit_computed_cols = 1
		BEGIN
			IF (SELECT COLUMNPROPERTY( OBJECT_ID(QUOTENAME(COALESCE(@owner,USER_NAME())) + </span><span class="dl">'</span><span class="p">.</span><span class="dl">'</span><span class="s1"> + @table_name),SUBSTRING(@Column_Name,2,LEN(@Column_Name) - 2),</span><span class="dl">'</span><span class="nx">IsComputed</span><span class="dl">'</span><span class="s1">)) = 1 
			BEGIN
				GOTO SKIP_LOOP					
			END
		END

		--Tables with columns of IMAGE data type are not supported for obvious reasons
		IF(@Data_Type in (</span><span class="dl">'</span><span class="nx">image</span><span class="dl">'</span><span class="s1">))
			BEGIN
				IF (@ommit_images = 0)
					BEGIN
						RAISERROR(</span><span class="dl">'</span><span class="nx">Tables</span> <span class="kd">with</span> <span class="nx">image</span> <span class="nx">columns</span> <span class="nx">are</span> <span class="nx">not</span> <span class="nx">supported</span><span class="p">.</span><span class="dl">'</span><span class="s1">,16,1)
						PRINT </span><span class="dl">'</span><span class="nx">Use</span> <span class="p">@</span><span class="nd">ommit_images</span> <span class="o">=</span> <span class="mi">1</span> <span class="nx">parameter</span> <span class="nx">to</span> <span class="nx">generate</span> <span class="nx">INSERTs</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">rest</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">columns</span><span class="p">.</span><span class="dl">'</span><span class="s1">
						PRINT </span><span class="dl">'</span><span class="nx">DO</span> <span class="nx">NOT</span> <span class="nx">ommit</span> <span class="nx">Column</span> <span class="nx">List</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">INSERT</span> <span class="nx">statements</span><span class="p">.</span> <span class="nx">If</span> <span class="nx">you</span> <span class="nx">ommit</span> <span class="nx">column</span> <span class="nx">list</span> <span class="nx">using</span> <span class="p">@</span><span class="nd">include_column_list</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">the</span> <span class="nx">generated</span> <span class="nx">INSERTs</span> <span class="nx">will</span> <span class="nx">fail</span><span class="p">.</span><span class="dl">'</span><span class="s1">
						RETURN -1 --Failure. Reason: There is a column with image data type
					END
				ELSE
					BEGIN
					GOTO SKIP_LOOP
					END
			END

		--Determining the data type of the column and depending on the data type, the VALUES part of
		--the INSERT statement is generated. Care is taken to handle columns with NULL values. Also
		--making sure, not to lose any data from flot, real, money, smallmomey, datetime columns
		SET @Actual_Values = @Actual_Values  +
		CASE 
			WHEN @Data_Type IN (</span><span class="dl">'</span><span class="nx">char</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="nx">varchar</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="nx">nchar</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="nx">nvarchar</span><span class="dl">'</span><span class="s1">) 
				THEN 
					</span><span class="dl">'</span><span class="nx">COALESCE</span><span class="p">(</span><span class="dl">''''''''</span> <span class="o">+</span> <span class="nx">REPLACE</span><span class="p">(</span><span class="nx">RTRIM</span><span class="p">(</span><span class="dl">'</span><span class="s1"> + @Column_Name + </span><span class="dl">'</span><span class="p">),</span><span class="dl">''''''''</span><span class="p">,</span><span class="dl">''''''''''''</span><span class="p">)</span><span class="o">+</span><span class="dl">''''''''</span><span class="p">,</span><span class="dl">''</span><span class="nx">NULL</span><span class="dl">''</span><span class="p">)</span><span class="dl">'</span><span class="s1">
			WHEN @Data_Type IN (</span><span class="dl">'</span><span class="nx">datetime</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="nx">smalldatetime</span><span class="dl">'</span><span class="s1">) 
				THEN 
					</span><span class="dl">'</span><span class="nx">COALESCE</span><span class="p">(</span><span class="dl">''''''''</span> <span class="o">+</span> <span class="nx">RTRIM</span><span class="p">(</span><span class="nx">CONVERT</span><span class="p">(</span><span class="nx">char</span><span class="p">,</span><span class="dl">'</span><span class="s1"> + @Column_Name + </span><span class="dl">'</span><span class="p">,</span><span class="mi">109</span><span class="p">))</span><span class="o">+</span><span class="dl">''''''''</span><span class="p">,</span><span class="dl">''</span><span class="nx">NULL</span><span class="dl">''</span><span class="p">)</span><span class="dl">'</span><span class="s1">
			WHEN @Data_Type IN (</span><span class="dl">'</span><span class="nx">uniqueidentifier</span><span class="dl">'</span><span class="s1">) 
				THEN  
					</span><span class="dl">'</span><span class="nx">COALESCE</span><span class="p">(</span><span class="dl">''''''''</span> <span class="o">+</span> <span class="nx">REPLACE</span><span class="p">(</span><span class="nx">CONVERT</span><span class="p">(</span><span class="nx">char</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span><span class="nx">RTRIM</span><span class="p">(</span><span class="dl">'</span><span class="s1"> + @Column_Name + </span><span class="dl">'</span><span class="p">)),</span><span class="dl">''''''''</span><span class="p">,</span><span class="dl">''''''''''''</span><span class="p">)</span><span class="o">+</span><span class="dl">''''''''</span><span class="p">,</span><span class="dl">''</span><span class="nx">NULL</span><span class="dl">''</span><span class="p">)</span><span class="dl">'</span><span class="s1">
			WHEN @Data_Type IN (</span><span class="dl">'</span><span class="nx">text</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="nx">ntext</span><span class="dl">'</span><span class="s1">) 
				THEN  
					</span><span class="dl">'</span><span class="nx">COALESCE</span><span class="p">(</span><span class="dl">''''''''</span> <span class="o">+</span> <span class="nx">REPLACE</span><span class="p">(</span><span class="nx">CONVERT</span><span class="p">(</span><span class="nx">char</span><span class="p">(</span><span class="mi">8000</span><span class="p">),</span><span class="dl">'</span><span class="s1"> + @Column_Name + </span><span class="dl">'</span><span class="p">),</span><span class="dl">''''''''</span><span class="p">,</span><span class="dl">''''''''''''</span><span class="p">)</span><span class="o">+</span><span class="dl">''''''''</span><span class="p">,</span><span class="dl">''</span><span class="nx">NULL</span><span class="dl">''</span><span class="p">)</span><span class="dl">'</span><span class="s1">					
			WHEN @Data_Type IN (</span><span class="dl">'</span><span class="nx">binary</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="nx">varbinary</span><span class="dl">'</span><span class="s1">) 
				THEN  
					</span><span class="dl">'</span><span class="nx">COALESCE</span><span class="p">(</span><span class="nx">RTRIM</span><span class="p">(</span><span class="nx">CONVERT</span><span class="p">(</span><span class="nx">char</span><span class="p">,</span><span class="dl">'</span><span class="s1"> + </span><span class="dl">'</span><span class="nx">CONVERT</span><span class="p">(</span><span class="nx">int</span><span class="p">,</span><span class="dl">'</span><span class="s1"> + @Column_Name + </span><span class="dl">'</span><span class="p">))),</span><span class="dl">''</span><span class="nx">NULL</span><span class="dl">''</span><span class="p">)</span><span class="dl">'</span><span class="s1">  
			WHEN @Data_Type IN (</span><span class="dl">'</span><span class="nx">timestamp</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="nx">rowversion</span><span class="dl">'</span><span class="s1">) 
				THEN  
					CASE 
						WHEN @include_timestamp = 0 
							THEN 
								</span><span class="dl">'''</span><span class="nx">DEFAULT</span><span class="dl">'''</span><span class="s1"> 
							ELSE 
								</span><span class="dl">'</span><span class="nx">COALESCE</span><span class="p">(</span><span class="nx">RTRIM</span><span class="p">(</span><span class="nx">CONVERT</span><span class="p">(</span><span class="nx">char</span><span class="p">,</span><span class="dl">'</span><span class="s1"> + </span><span class="dl">'</span><span class="nx">CONVERT</span><span class="p">(</span><span class="nx">int</span><span class="p">,</span><span class="dl">'</span><span class="s1"> + @Column_Name + </span><span class="dl">'</span><span class="p">))),</span><span class="dl">''</span><span class="nx">NULL</span><span class="dl">''</span><span class="p">)</span><span class="dl">'</span><span class="s1">  
					END
			WHEN @Data_Type IN (</span><span class="dl">'</span><span class="nx">float</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="nx">real</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="nx">money</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="nx">smallmoney</span><span class="dl">'</span><span class="s1">)
				THEN
					</span><span class="dl">'</span><span class="nx">COALESCE</span><span class="p">(</span><span class="nx">LTRIM</span><span class="p">(</span><span class="nx">RTRIM</span><span class="p">(</span><span class="dl">'</span><span class="s1"> + </span><span class="dl">'</span><span class="nx">CONVERT</span><span class="p">(</span><span class="nx">char</span><span class="p">,</span> <span class="dl">'</span><span class="s1"> +  @Column_Name  + </span><span class="dl">'</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="dl">'</span><span class="s1"> + </span><span class="dl">'</span><span class="p">)),</span><span class="dl">''</span><span class="nx">NULL</span><span class="dl">''</span><span class="p">)</span><span class="dl">'</span><span class="s1"> 
			ELSE 
				</span><span class="dl">'</span><span class="nx">COALESCE</span><span class="p">(</span><span class="nx">LTRIM</span><span class="p">(</span><span class="nx">RTRIM</span><span class="p">(</span><span class="dl">'</span><span class="s1"> + </span><span class="dl">'</span><span class="nx">CONVERT</span><span class="p">(</span><span class="nx">char</span><span class="p">,</span> <span class="dl">'</span><span class="s1"> +  @Column_Name  + </span><span class="dl">'</span><span class="p">)</span><span class="dl">'</span><span class="s1"> + </span><span class="dl">'</span><span class="p">)),</span><span class="dl">''</span><span class="nx">NULL</span><span class="dl">''</span><span class="p">)</span><span class="dl">'</span><span class="s1"> 
		END   + </span><span class="dl">'</span><span class="o">+</span><span class="dl">'</span><span class="s1"> +  </span><span class="dl">'''</span><span class="p">,</span><span class="dl">'''</span><span class="s1"> + </span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">

		--Generating the column list for the INSERT statement
		SET @Column_List = @Column_List +  @Column_Name + </span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">	

		SKIP_LOOP: --The label used in GOTO

		SELECT 	@Column_ID = MIN(ORDINAL_POSITION) 
		FROM 	INFORMATION_SCHEMA.COLUMNS (NOLOCK) 
		WHERE 	TABLE_NAME = @table_name AND 
		ORDINAL_POSITION &gt; @Column_ID AND
		(@owner IS NULL OR TABLE_SCHEMA = @owner)

	--Loop ends here!
	END

--To get rid of the extra characters that got concatenated during the last run through the loop
SET @Column_List = LEFT(@Column_List,len(@Column_List) - 1)
SET @Actual_Values = LEFT(@Actual_Values,len(@Actual_Values) - 6)

IF LTRIM(@Column_List) = </span><span class="dl">''</span><span class="s1"> 
	BEGIN
		RAISERROR(</span><span class="dl">'</span><span class="nx">No</span> <span class="nx">columns</span> <span class="nx">to</span> <span class="nx">select</span><span class="p">.</span> <span class="nx">There</span> <span class="nx">should</span> <span class="nx">at</span> <span class="nx">least</span> <span class="nx">be</span> <span class="nx">one</span> <span class="nx">column</span> <span class="nx">to</span> <span class="nx">generate</span> <span class="nx">the</span> <span class="nx">output</span><span class="dl">'</span><span class="s1">,16,1)
		RETURN -1 --Failure. Reason: Looks like all the columns are ommitted using the @cols_to_exclude parameter
	END

--Forming the final string that will be executed, to output the INSERT statements
IF (@include_column_list &lt;&gt; 0)
	BEGIN
		SET @Actual_Values = 
			</span><span class="dl">'</span><span class="nx">SELECT</span> <span class="dl">'</span><span class="s1"> +  
			CASE WHEN @top IS NULL OR @top &lt; 0="" then="" </span><span class="dl">''</span><span class="s1">="" else="" </span><span class="dl">'</span><span class="o">=</span><span class="dl">""</span> <span class="nx">top</span><span class="o">=</span><span class="dl">""</span> <span class="dl">'</span><span class="s1">="" +="" ltrim(str(@top))="" +="" </span><span class="dl">'</span><span class="o">=</span><span class="dl">""</span> <span class="dl">'</span><span class="s1">="" end="" +="" </span><span class="dl">''''</span><span class="s1">="" +="" rtrim(@start_insert)="" +="" </span><span class="dl">'</span><span class="o">=</span><span class="dl">""</span> <span class="dl">''</span><span class="o">+</span><span class="dl">'</span><span class="s1">="" +="" </span><span class="dl">'''</span><span class="p">(</span><span class="dl">'</span><span class="s1">="" +="" rtrim(@column_list)="" +="" </span><span class="dl">'''</span><span class="o">+</span><span class="dl">'</span><span class="s1">="" +="" </span><span class="dl">'''</span><span class="p">)</span><span class="dl">'''</span><span class="s1">="" +="" </span><span class="dl">'</span><span class="o">=</span><span class="dl">""</span> <span class="o">+</span><span class="dl">''</span><span class="nx">values</span><span class="p">(</span><span class="dl">''</span><span class="o">+=</span><span class="dl">""</span> <span class="dl">'</span><span class="s1">="" +="" @actual_values="" +="" </span><span class="dl">'</span><span class="o">+</span><span class="dl">''</span><span class="p">)</span><span class="dl">'''</span><span class="s1">="" +="" </span><span class="dl">'</span><span class="o">=</span><span class="dl">""</span> <span class="dl">'</span><span class="s1">="" +="" coalesce(@from,</span><span class="dl">'</span><span class="o">=</span><span class="dl">""</span> <span class="k">from</span><span class="o">=</span><span class="dl">""</span> <span class="dl">'</span><span class="s1">="" +="" case="" when="" @owner="" is="" null="" then="" </span><span class="dl">''</span><span class="s1">="" else="" </span><span class="dl">'</span><span class="p">[</span><span class="dl">'</span><span class="s1">="" +="" ltrim(rtrim(@owner))="" +="" </span><span class="dl">'</span><span class="p">].</span><span class="dl">'</span><span class="s1">="" end="" +="" </span><span class="dl">'</span><span class="p">[</span><span class="dl">'</span><span class="s1">="" +="" rtrim(@table_name)="" +="" </span><span class="dl">'</span><span class="p">]</span><span class="dl">'</span><span class="s1">="" +="" </span><span class="dl">'</span><span class="p">(</span><span class="nx">nolock</span><span class="p">)</span><span class="dl">'</span><span class="s1">)="" end="" else="" if="" (@include_column_list="0)" begin="" set="" @actual_values=</span><span class="dl">'</span><span class="nx">SELECT</span> <span class="dl">'</span><span class="s1"> +="" case="" when="" @top="" is="" null="" or="" @top=""&gt;&lt; 0="" then="" </span><span class="dl">''</span><span class="s1">="" else="" </span><span class="dl">'</span><span class="o">=</span><span class="dl">""</span> <span class="nx">top</span><span class="o">=</span><span class="dl">""</span> <span class="dl">'</span><span class="s1">="" +="" ltrim(str(@top))="" +="" </span><span class="dl">'</span><span class="o">=</span><span class="dl">""</span> <span class="dl">'</span><span class="s1">="" end="" +="" </span><span class="dl">''''</span><span class="s1">="" +="" rtrim(@start_insert)="" +="" </span><span class="dl">'</span><span class="o">=</span><span class="dl">""</span> <span class="dl">''</span><span class="o">=</span><span class="dl">""</span> <span class="o">+</span><span class="dl">''</span><span class="nx">values</span><span class="p">(</span><span class="dl">''</span><span class="o">+=</span><span class="dl">""</span> <span class="dl">'</span><span class="s1">="" +="" @actual_values="" +="" </span><span class="dl">'</span><span class="o">+</span><span class="dl">''</span><span class="p">)</span><span class="dl">'''</span><span class="s1">="" +="" </span><span class="dl">'</span><span class="o">=</span><span class="dl">""</span> <span class="dl">'</span><span class="s1">="" +="" coalesce(@from,</span><span class="dl">'</span><span class="o">=</span><span class="dl">""</span> <span class="k">from</span><span class="o">=</span><span class="dl">""</span> <span class="dl">'</span><span class="s1">="" +="" case="" when="" @owner="" is="" null="" then="" </span><span class="dl">''</span><span class="s1">="" else="" </span><span class="dl">'</span><span class="p">[</span><span class="dl">'</span><span class="s1">="" +="" ltrim(rtrim(@owner))="" +="" </span><span class="dl">'</span><span class="p">].</span><span class="dl">'</span><span class="s1">="" end="" +="" </span><span class="dl">'</span><span class="p">[</span><span class="dl">'</span><span class="s1">="" +="" rtrim(@table_name)="" +="" </span><span class="dl">'</span><span class="p">]</span><span class="dl">'</span><span class="s1">="" +="" </span><span class="dl">'</span><span class="p">(</span><span class="nx">nolock</span><span class="p">)</span><span class="dl">'</span><span class="s1">)="" end="" --determining="" whether="" to="" ouput="" any="" debug="" information="" if="" @debug_mode="1" begin="" print="" </span><span class="dl">'</span><span class="cm">/*****start="" of="" debug="" information*****'="" print="" 'beginning="" of="" the="" insert="" statement:'="" print="" @start_insert="" print="" ''="" print="" 'the="" column="" list:'="" print="" @column_list="" print="" ''="" print="" 'the="" select="" statement="" executed="" to="" generate="" the="" inserts'="" print="" @actual_values="" print="" ''="" print="" '*****end="" of="" debug="" information*****/</span><span class="dl">'</span><span class="s1">="" print="" </span><span class="dl">''</span><span class="s1">="" end="" print="" </span><span class="dl">'</span><span class="o">--</span><span class="nx">inserts</span><span class="o">=</span><span class="dl">""</span> <span class="nx">generated</span><span class="o">=</span><span class="dl">""</span> <span class="nx">by</span><span class="o">=</span><span class="dl">""</span> <span class="dl">''</span><span class="nx">sp_generate_inserts</span><span class="dl">''</span><span class="o">=</span><span class="dl">""</span> <span class="nx">stored</span><span class="o">=</span><span class="dl">""</span> <span class="nx">procedure</span><span class="o">=</span><span class="dl">""</span> <span class="nx">written</span><span class="o">=</span><span class="dl">""</span> <span class="nx">by</span><span class="o">=</span><span class="dl">""</span> <span class="nx">vyas</span><span class="dl">'</span><span class="s1">="" print="" </span><span class="dl">'</span><span class="o">--</span><span class="nx">build</span><span class="o">=</span><span class="dl">""</span> <span class="nx">number</span><span class="p">:</span><span class="o">=</span><span class="dl">""</span> <span class="mi">22</span><span class="dl">'</span><span class="s1">="" print="" </span><span class="dl">'</span><span class="o">--</span><span class="nx">problems</span><span class="o">/</span><span class="nx">suggestions</span><span class="p">?</span><span class="o">=</span><span class="dl">""</span> <span class="nx">contact</span><span class="o">=</span><span class="dl">""</span> <span class="nx">vyas</span><span class="o">=</span><span class="dl">""</span> <span class="p">@</span><span class="o">=</span><span class="dl">""</span> <span class="nx">vyaskn</span><span class="p">@</span><span class="nd">hotmail</span><span class="p">.</span><span class="nx">com</span><span class="dl">'</span><span class="s1">="" print="" </span><span class="dl">'</span><span class="o">--</span><span class="nx">http</span><span class="p">:</span><span class="c1">//vyaskn.tripod.com'="" print="" ''="" print="" 'set="" nocount="" on'="" print="" ''="" --determining="" whether="" to="" print="" identity_insert="" or="" not="" if="" (@idn=""&gt;&lt;&gt; '')</span>
	<span class="nx">BEGIN</span>
		<span class="nx">PRINT</span> <span class="dl">'</span><span class="s1">SET IDENTITY_INSERT </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">QUOTENAME</span><span class="p">(</span><span class="nx">COALESCE</span><span class="p">(@</span><span class="nd">owner</span><span class="p">,</span><span class="nx">USER_NAME</span><span class="p">()))</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">.</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">QUOTENAME</span><span class="p">(@</span><span class="nd">table_name</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> ON</span><span class="dl">'</span>
		<span class="nx">PRINT</span> <span class="dl">'</span><span class="s1">GO</span><span class="dl">'</span>
		<span class="nx">PRINT</span> <span class="dl">''</span>
	<span class="nx">END</span>

<span class="nx">IF</span> <span class="p">@</span><span class="nd">disable_constraints</span> <span class="o">=</span> <span class="mi">1</span> <span class="nx">AND</span> <span class="p">(</span><span class="nx">OBJECT_ID</span><span class="p">(</span><span class="nx">QUOTENAME</span><span class="p">(</span><span class="nx">COALESCE</span><span class="p">(@</span><span class="nd">owner</span><span class="p">,</span><span class="nx">USER_NAME</span><span class="p">()))</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">.</span><span class="dl">'</span> <span class="o">+</span> <span class="p">@</span><span class="nd">table_name</span><span class="p">,</span> <span class="dl">'</span><span class="s1">U</span><span class="dl">'</span><span class="p">)</span> <span class="nx">IS</span> <span class="nx">NOT</span> <span class="nx">NULL</span><span class="p">)</span>
	<span class="nx">BEGIN</span>
		<span class="nx">IF</span> <span class="p">@</span><span class="nd">owner</span> <span class="nx">IS</span> <span class="nx">NULL</span>
			<span class="nx">BEGIN</span>
				<span class="nx">SELECT</span> 	<span class="dl">'</span><span class="s1">ALTER TABLE </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">QUOTENAME</span><span class="p">(</span><span class="nx">COALESCE</span><span class="p">(@</span><span class="nd">target_table</span><span class="p">,</span> <span class="p">@</span><span class="nd">table_name</span><span class="p">))</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> NOCHECK CONSTRAINT ALL</span><span class="dl">'</span> <span class="nx">AS</span> <span class="dl">'</span><span class="s1">--Code to disable constraints temporarily</span><span class="dl">'</span>
			<span class="nx">END</span>
		<span class="nx">ELSE</span>
			<span class="nx">BEGIN</span>
				<span class="nx">SELECT</span> 	<span class="dl">'</span><span class="s1">ALTER TABLE </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">QUOTENAME</span><span class="p">(@</span><span class="nd">owner</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">.</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">QUOTENAME</span><span class="p">(</span><span class="nx">COALESCE</span><span class="p">(@</span><span class="nd">target_table</span><span class="p">,</span> <span class="p">@</span><span class="nd">table_name</span><span class="p">))</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> NOCHECK CONSTRAINT ALL</span><span class="dl">'</span> <span class="nx">AS</span> <span class="dl">'</span><span class="s1">--Code to disable constraints temporarily</span><span class="dl">'</span>
			<span class="nx">END</span>

		<span class="nx">PRINT</span> <span class="dl">'</span><span class="s1">GO</span><span class="dl">'</span>
	<span class="nx">END</span>

<span class="nx">PRINT</span> <span class="dl">''</span>
<span class="nx">PRINT</span> <span class="dl">'</span><span class="s1">PRINT </span><span class="dl">''</span><span class="s1">Inserting values into </span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">[</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">RTRIM</span><span class="p">(</span><span class="nx">COALESCE</span><span class="p">(@</span><span class="nd">target_table</span><span class="p">,@</span><span class="nd">table_name</span><span class="p">))</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">]</span><span class="dl">'</span> <span class="o">+</span> <span class="dl">''''</span>

<span class="o">--</span><span class="nx">All</span> <span class="nx">the</span> <span class="nx">hard</span> <span class="nx">work</span> <span class="nx">pays</span> <span class="nx">off</span> <span class="nx">here</span><span class="o">!!!</span> <span class="nx">You</span><span class="dl">'</span><span class="s1">ll get your INSERT statements, when the next line executes!
EXEC (@Actual_Values)

PRINT </span><span class="dl">'</span><span class="nx">PRINT</span> <span class="dl">''</span><span class="nx">Done</span><span class="dl">'''</span><span class="s1">
PRINT </span><span class="dl">''</span><span class="s1">

IF @disable_constraints = 1 AND (OBJECT_ID(QUOTENAME(COALESCE(@owner,USER_NAME())) + </span><span class="dl">'</span><span class="p">.</span><span class="dl">'</span><span class="s1"> + @table_name, </span><span class="dl">'</span><span class="nx">U</span><span class="dl">'</span><span class="s1">) IS NOT NULL)
	BEGIN
		IF @owner IS NULL
			BEGIN
				SELECT 	</span><span class="dl">'</span><span class="nx">ALTER</span> <span class="nx">TABLE</span> <span class="dl">'</span><span class="s1"> + QUOTENAME(COALESCE(@target_table, @table_name)) + </span><span class="dl">'</span> <span class="nx">CHECK</span> <span class="nx">CONSTRAINT</span> <span class="nx">ALL</span><span class="dl">'</span><span class="s1">  AS </span><span class="dl">'</span><span class="o">--</span><span class="nx">Code</span> <span class="nx">to</span> <span class="nx">enable</span> <span class="nx">the</span> <span class="nx">previously</span> <span class="nx">disabled</span> <span class="nx">constraints</span><span class="dl">'</span><span class="s1">
			END
		ELSE
			BEGIN
				SELECT 	</span><span class="dl">'</span><span class="nx">ALTER</span> <span class="nx">TABLE</span> <span class="dl">'</span><span class="s1"> + QUOTENAME(@owner) + </span><span class="dl">'</span><span class="p">.</span><span class="dl">'</span><span class="s1"> + QUOTENAME(COALESCE(@target_table, @table_name)) + </span><span class="dl">'</span> <span class="nx">CHECK</span> <span class="nx">CONSTRAINT</span> <span class="nx">ALL</span><span class="dl">'</span><span class="s1"> AS </span><span class="dl">'</span><span class="o">--</span><span class="nx">Code</span> <span class="nx">to</span> <span class="nx">enable</span> <span class="nx">the</span> <span class="nx">previously</span> <span class="nx">disabled</span> <span class="nx">constraints</span><span class="dl">'</span><span class="s1">
			END

		PRINT </span><span class="dl">'</span><span class="nx">GO</span><span class="dl">'</span><span class="s1">
	END

PRINT </span><span class="dl">''</span><span class="s1">
IF (@IDN &lt;&gt; </span><span class="dl">''</span><span class="s1">)
	BEGIN
		PRINT </span><span class="dl">'</span><span class="nx">SET</span> <span class="nx">IDENTITY_INSERT</span> <span class="dl">'</span><span class="s1"> + QUOTENAME(COALESCE(@owner,USER_NAME())) + </span><span class="dl">'</span><span class="p">.</span><span class="dl">'</span><span class="s1"> + QUOTENAME(@table_name) + </span><span class="dl">'</span> <span class="nx">OFF</span><span class="dl">'</span><span class="s1">
		PRINT </span><span class="dl">'</span><span class="nx">GO</span><span class="dl">'</span><span class="s1">
	END

PRINT </span><span class="dl">'</span><span class="nx">SET</span> <span class="nx">NOCOUNT</span> <span class="nx">OFF</span><span class="dl">'</span><span class="s1">

SET NOCOUNT OFF
RETURN 0 --Success. We are done!
END

GO

PRINT </span><span class="dl">'</span><span class="nx">Created</span> <span class="nx">the</span> <span class="nx">procedure</span><span class="dl">'</span><span class="s1">
GO

--Mark procedure as system object
EXEC sys.sp_MS_marksystemobject sp_generate_inserts
GO

PRINT </span><span class="dl">'</span><span class="nx">Granting</span> <span class="nx">EXECUTE</span> <span class="nx">permission</span> <span class="nx">on</span> <span class="nx">sp_generate_inserts</span> <span class="nx">to</span> <span class="nx">all</span> <span class="nx">users</span><span class="dl">'</span><span class="s1">
GRANT EXEC ON sp_generate_inserts TO public

SET NOCOUNT OFF
GO

PRINT </span><span class="dl">'</span><span class="nx">Done</span><span class="dl">'</span><span class="s1">
</span></pre></table></code></div></div><h3 id="method-2">Method 2</h3><p>```js IF EXISTS (SELECT * FROM sysobjects WHERE xtype = ‘P’ AND name = ‘spu_GenerateInsert’) BEGIN DROP PROCEDURE spu_GenerateInsert END GO</p><p>CREATE PROCEDURE spu_GenerateInsert @table varchar(128), – used to specify the table to generate data for @generateGo bit = 0, – used to allow GO statements to separate the insert statements @restriction varchar(1000) = ‘’, – used to allow the data set to be restricted, no need for the where clause but can use syntax as ‘columna = 1’ @producesingleinsert bit = 0, – used to switch the ability to produce multiple insert statements (default) or one statement using UNION SELECT @debug bit = 0, – used to allow debugging to be turned on to the stored procedure - in case of queries @GenerateOneLinePerColumn bit = 0, – used to display the columns and data on separate lines @GenerateIdentityColumn bit = 1 – used to prevent the identity columns from being scripted AS /<strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong>* Original Author: Keith E Kratochvil</p><p>This version: Jane Dallaway</p><p>Updates at: http://jane.dallaway.com/downloads/SQL/spu_generateInsert.sql</p><p>Documentation at: http://jane.dallaway.com/blog/labels/spu_generateinsert.html</p><p>Date Created: March 16, 2000</p><p>Description: This procedure takes the data from a table and turns it into an insert statement.</p><p>CAUTION!!! If you run this on a large table be prepared to wait a while!</p><p>Modified: add a comment here (date, who, comment)</p><p>Date Name Description ~~~~~~~ ~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 07/11/03 Jane Added a @generateGO parameter to allow selection 07/11/03 Jane This procedure has an issue with NULLs…. 07/11/03 Jane Deal with Identities 07/11/03 Jane Wrap all tablenames and columns with [ and ] 15/12/03 Jane For DateTimes covert as style 1 - to allow for mm/dd/yyy 16/12/03 Jane Get rid of rowcount 18/12/03 Jane Prevent single field tables having that field displayed twice 06/07/04 Jane Large money values get separeted with a comma - so specify convert with 0 rather than 1 <br /> 31/05/05 Jane Added default for GenerateGo and added ability to generate Inserts for selected records based on the restriction 03/01/08 Jane Updated to cope with text and ntext. It converts to VARCHAR(8000) to allow quote escaping Also copes with Nulls much better now. 07/01/08 Jane Now handles guids 07/01/08 Jane Forced collation to use database_default as was causing an error in some circumstances 15/01/08 Jane Dave reported issue with image column types as a comment on my blog http://jane.dallaway.com/blog/2007/11/generate-sql-insert-statement-from.html#c9038036788352783369 So, ensured that all column types either work, or replace with NULL and add warning 23/01/08 Jane Ignore calculated columns. Can’t migrate the data, so remove from the INSERT Implemented a suggestion from Jon Green - 4R Systems Inc left on my blog post at http://jane.dallaway.com/blog/2007/11/generate-sql-insert-statement-from.html#c2055936172890486440 to allow a choice of separate insert statements or a single statement using the UNION SELECT syntax. New parameter @producesingleinsert used. When this is set to 0 it produces separate INSERT statements. When set to 1 it produces a single statment using UNION SELECT 20/08/08 Jane New parameter @GenerateOneLinePerColumn added as suggested by Christian via comment on my blog post at http://jane.dallaway.com/blog/2007/11/generate-sql-insert-statement-from.html?showComment=1219174920000#c6992035307857457643 Also made all string variables varchar(max). This means it no longer works on SQL 2000 - but to make it do so is just a case of putting all varchar(max) to varchar(8000) 07/01/09 Jane New parameter @GenerateIdentityColumns added as suggestion by James Bradshaw to enable identity columns to not be scripted and therefore rely on the database to populate the identities from scratch 16/02/09 Jane Continuation of work started on 20/08/08 - all remaining VARCHAR(8000)s removed and replaced with VARCHAR(max). So, no longer an issue with text columns unless it is SQL Server 2000, in which case this stored procedure will need to have been updated.<br /> 16/04/09 Jane Add checking to see if the table specified actually exists - user error on my case when using the procedure 17/04/09 Jane Changed @tabledata to be nvarchar rather than varchar to allow for unicode <br /> Added checking for data exceeding 8000 bytes and split the data based on CHAR(13) if this situation is seen.<br /> This won’t resolve it in all cases, and if it doesn’t then a warning is displayed at the bottom of the generated code 08/06/09 Jane All strings are now output as N’<data>' rather than '<data>' to cope with extended character sets</data></data></p><p>Known Issues: <br /> 1) BLOBs can’t be output</p><p>Usage: exec spu_GenerateInsert @table =’users’, @generateGo=0, @restriction=’columna = x’, @producesingleinsert=0, @debug=0, @GenerateOneLinePerColumn=0, @GenerateIdentityColumn=0</p><p>Version: This version has been tested on SQL Server 2005. To make this work on SQL Server 2000, replace all instances of VARCHAR(max) with VARCHAR(8000). This will limit the ability of export of text and XML columns to 8000 characters</p><p><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong>*/</p><p>–Variable declarations DECLARE @InsertStmt varchar(max) – change this to be (8000) for SQL Server 2000 DECLARE @Fields varchar(max) – change this to be (8000) for SQL Server 2000 DECLARE @SelList varchar(max) – change this to be (8000) for SQL Server 2000 DECLARE @Data varchar(max) – change this to be (8000) for SQL Server 2000 DECLARE @ColName varchar(128) DECLARE @IsChar tinyint DECLARE @FldCounter int DECLARE @TableData nvarchar(max) – change this to be (8000) for SQL Server 2000</p><p>– added by Jane - 07/11/03 DECLARE @bitIdentity BIT</p><p>– added by Jane 03/01/08 DECLARE @bitHasEncounteredText BIT SET @bitHasEncounteredText = 0</p><p>– added by Jane 15/01/08 DECLARE @bitHasEncounteredImage BIT SET @bitHasEncounteredImage = 0 DECLARE @bitHasEncounteredBinary BIT SET @bitHasEncounteredBinary = 0 DECLARE @bitHasEncounteredXML BIT SET @bitHasEncounteredXML = 0</p><p>– added by Jane - 23/01/08 DECLARE @bitInsertStatementPrinted BIT SET @bitInsertStatementPrinted = 0</p><p>– added by Jane - 17/04/09 - To try and cope with bits of data which are greater than 8000 bytes DECLARE @bitDataExceedMaxPrintLength BIT SET @bitDataExceedMaxPrintLength = 0 DECLARE @cintMaximumSupportedPrintByteCount INT SET @cintMaximumSupportedPrintByteCount = 8000 – based on SQL Server 2005 DECLARE @statementToOutput NVARCHAR(max) – change this to be (8000) for SQL Server 2000 DECLARE @NextCR INT – used to split the output up into smaller chunks - look for carriage returns/line feeds and break into separate print statements DECLARE @statementsToOutput TABLE (Id INT IDENTITY(1,1), singleStatement NVARCHAR (max) ) – change this to be (8000) for SQL Server 2000 DECLARE @id INT DECLARE @singleStatement NVARCHAR(max) – change this to be (8000) for SQL Server 2000 DECLARE @loop INT</p><p>– added by Jane - 16/12/03 SET NOCOUNT OFF</p><p>– added by Jane - 16/04/09 - check for table existance IF EXISTS(SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = @table) BEGIN</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
</pre><td class="rouge-code"><pre> -- added by Jane - 16/04/2009 - Show details of table being generated, and date/time
 PRINT REPLICATE('-', 37 + LEN(@table) + LEN(CONVERT(VARCHAR,GETDATE(),120)))          
 PRINT '-- Script generated for table ' + @table + ' on ' + CONVERT(VARCHAR,GETDATE(),120) + ' --'
 PRINT REPLICATE('-', 37 + LEN(@table) + LEN(CONVERT(VARCHAR,GETDATE(),120)))

 -- added by Jane - 07/11/03
 SELECT @bitIdentity = OBJECTPROPERTY(OBJECT_ID(TABLE_NAME), 'TableHasIdentity')
 FROM INFORMATION_SCHEMA.TABLES
 WHERE TABLE_Name =@table

 -- added by Jane - 03/01/08
 PRINT '-- ** Start of Inserts ** --'
 PRINT ''

 -- added by Jane - 07/11/03
 -- AND @GenerateIdentityColumn = 1 added by Jane - 07/01/09
 IF @bitIdentity = 1 AND @GenerateIdentityColumn = 1
 BEGIN
       PRINT 'SET IDENTITY_INSERT [' + @table + '] ON '
 END

 --initialize some of the variables
 -- updated by Jane 20/08/08 added one line per column functionality as per Christian's suggestion
 SELECT @InsertStmt = 'INSERT INTO [' + @Table + '] '+ CASE WHEN @GenerateOneLinePerColumn = 1 THEN CHAR(13) ELSE '' END + '(' + CASE WHEN @GenerateOneLinePerColumn = 1 THEN CHAR(13) ELSE '' END,
       @Fields = '',
       @Data = '',
       @SelList = 'SELECT ',
       @FldCounter = 0

 --create a cursor that loops through the fields in the table
 --and retrieves the column names and determines the delimiter type that the
 --field needs
 DECLARE CR_Table CURSOR FAST_FORWARD FOR

       SELECT COLUMN_NAME,
              'IsChar' = CASE
              WHEN DATA_TYPE in ('int', 'money', 'decimal', 'tinyint', 'smallint' ,'numeric', 'bit', 'bigint', 'smallmoney', 'float','timestamp') THEN 0
              WHEN DATA_TYPE in ('char', 'varchar', 'nvarchar','uniqueidentifier', 'nchar') THEN 1
              WHEN DATA_TYPE in ('datetime', 'smalldatetime') THEN 2
              WHEN DATA_TYPE in ('text', 'ntext') THEN 3
              WHEN DATA_TYPE in ('image') THEN 4 -- added by Jane - 15/01/08
              WHEN DATA_TYPE in ('binary', 'varbinary') THEN 5 -- added by Jane - 15/01/08
              WHEN DATA_TYPE in ('sql_variant') THEN 6 -- added by Jane - 15/01/08 - Force to be converted as varchars
              WHEN DATA_TYPE in ('xml') THEN 7 -- added by Jane - 15/01/08
              ELSE 9
       END
       FROM INFORMATION_SCHEMA.COLUMNS c WITH (NOLOCK)
       INNER JOIN syscolumns sc WITH (NOLOCK)
       ON c.COLUMN_NAME = sc.name
       INNER JOIN sysobjects so WITH (NOLOCK)
       ON sc.id = so.id
       AND so.name = c.TABLE_NAME
       WHERE table_name = @table
       AND DATA_TYPE &lt;&gt;'timestamp'
       AND sc.IsComputed = 0      
       AND 1 = 
           CASE @GenerateIdentityColumn 
           WHEN 1 -- When we want the identity columns to be generated, then always include the column
           THEN 1 
           ELSE 
                CASE COLUMNPROPERTY(object_id(TABLE_NAME), COLUMN_NAME, 'IsIdentity') -- Check if the column has the property IsIdentity
                WHEN 1 -- If it does
                THEN 0 -- don't include this column
                ELSE 1 -- otherwise include this column
                END
           END
       ORDER BY ORDINAL_POSITION
       FOR READ ONLY
       OPEN CR_Table

       FETCH NEXT FROM CR_Table INTO @ColName, @IsChar

 WHILE (@@fetch_status &lt;&gt; -1)
 BEGIN

       IF @IsChar = 3
              SET @bitHasEncounteredText = 1           

       -- added by Jane - 15/01/08
       IF @IsChar = 4
              SET @bitHasEncounteredImage = 1
       IF @IsChar = 5
              SET @bitHasEncounteredBinary = 1

       IF (@@fetch_status &lt;&gt; -2)
       BEGIN

              -- Updated by Jane - 15/01/08 - cope with xml, image, binary, varbinary etc
              -- Updated by Jane - 03/01/08 to cope with text and ntext - converts to VARCHAR(8000) to allow quote escaping
              -- Special case for first field
              IF @FldCounter = 0
              BEGIN
                      SELECT @Fields =  @Fields + '[' + @ColName + ']' + ', '
                      -- Updated by Jane - 08/06/09 - prefix string with N to cope with extended character sets                          
                      SELECT @SelList =  CASE @IsChar
                             WHEN 1 THEN @SelList +  ' ISNULL(''N'''''' + REPLACE(['+  @ColName + '],'''''''', '''''''''''') + '''''''' ,''NULL'')  ' + ' COLLATE database_default + '
                             WHEN 2 THEN @SelList +  ' ISNULL(''N'''''' + CONVERT(varchar(20),[' + @ColName + ']) + '''''''',''NULL'') ' + ' COLLATE database_default + '
                             WHEN 3 THEN @SelList +  ' ISNULL(''N'''''' + REPLACE(CONVERT(VARCHAR(max),['+  @ColName + ']),'''''''', '''''''''''')+  '''''''' ,''NULL'')  '+ ' COLLATE database_default + '
                             WHEN 4 THEN @SelList + '''NULL''' + ' COLLATE database_default + '
                             WHEN 5 THEN @SelList + '''NULL''' + ' COLLATE database_default + '
                             WHEN 6 THEN @SelList +  ' ISNULL(''N'''''' + REPLACE(CONVERT(VARCHAR(max),['+  @ColName + ']),'''''''', '''''''''''')+  '''''''' ,''NULL'')  '+ ' COLLATE database_default + '
                             WHEN 7 THEN @SelList +  ' ISNULL(''N'''''' + REPLACE(CONVERT(VARCHAR(max),['+  @ColName + ']),'''''''', '''''''''''')+  '''''''' ,''NULL'')  '+ ' COLLATE database_default + '
                             ELSE @SelList + 'ISNULL(CONVERT(varchar(2000),['+@ColName + '],0),''NULL'')' + ' COLLATE database_default + '
                             END
                      SELECT @FldCounter = @FldCounter + 1
                      SET @SelList = @Sellist
                      FETCH NEXT FROM CR_Table INTO @ColName, @IsChar
              END

              -- Updated by Jane - 15/01/08 - cope with xml, image, binary, varbinary etc
              -- Updated by Jane - 03/01/08 to cope with NULL replacements           
              -- Updated by Jane - 03/01/08 to cope with text and ntext - converts to VARCHAR(8000) to allow quote escaping
              -- Updated by Jane - 18/12/03 to prevent single field tables having that field displayed twice
              -- Updated by Jane - 20/08/08 to incorporate the @GenerateOneLinePerColumn parameter suggested by Christian
              IF @@fetch_status &lt;&gt; -1
              BEGIN
                      SELECT @Fields =  @Fields + '[' + @ColName + ']' + ', '
                      -- Updated by Jane - 08/06/09 - prefix string with N to cope with extended character sets
                      SELECT @SelList =  CASE @IsChar
                             WHEN 1 THEN @SelList +  ''',''' + CASE WHEN @GenerateOneLinePerColumn = 1 THEN ' + CHAR(13) ' ELSE '' END + ' + ' +  ' ISNULL(''N'''''' + REPLACE(['+  @ColName + '],'''''''', '''''''''''' ) +  '''''''',''NULL'') ' + ' COLLATE database_default + '
                             WHEN 2 THEN @SelList + ''',''' + CASE WHEN @GenerateOneLinePerColumn = 1 THEN  ' + CHAR(13) ' ELSE '' END + ' + '  +  'ISNULL(''N'''''' + CONVERT(varchar(20),['+ @ColName + '])+ '''''''',''NULL'') ' + ' COLLATE database_default + '
                             WHEN 3 THEN @SelList +  ''',''' + CASE WHEN @GenerateOneLinePerColumn = 1 THEN ' + CHAR(13) ' ELSE '' END + ' + ' +  ' ISNULL(''N'''''' + REPLACE(CONVERT(VARCHAR(max),['+  @ColName + ']),'''''''', '''''''''''' )+  '''''''',''NULL'')  ' + ' COLLATE database_default + '
                             WHEN 4 THEN @SelList + ''',''' + CASE WHEN @GenerateOneLinePerColumn = 1 THEN  ' + CHAR(13) ' ELSE '' END + ' + ' +  '''NULL''' + ' COLLATE database_default + '
                             WHEN 5 THEN @SelList + ''',''' + CASE WHEN @GenerateOneLinePerColumn = 1 THEN  ' + CHAR(13) ' ELSE '' END + ' + ' +  '''NULL''' + ' COLLATE database_default + '
                             WHEN 6 THEN @SelList + ''',''' + CASE WHEN @GenerateOneLinePerColumn = 1 THEN  ' + CHAR(13) ' ELSE '' END + ' + ' +   ' ISNULL(''N'''''' + REPLACE(CONVERT(VARCHAR(max),['+  @ColName + ']),'''''''', '''''''''''')+  '''''''' ,''NULL'')  '+ ' COLLATE database_default + '
                             WHEN 7 THEN @SelList + ''',''' + CASE WHEN @GenerateOneLinePerColumn = 1 THEN  ' + CHAR(13) ' ELSE '' END + ' + ' +   ' ISNULL(''N'''''' + REPLACE(CONVERT(VARCHAR(max),['+  @ColName + ']),'''''''', '''''''''''')+  '''''''' ,''NULL'')  '+ ' COLLATE database_default + '
                             ELSE @SelList  + ''',''' + CASE WHEN @GenerateOneLinePerColumn = 1 THEN  ' + CHAR(13) ' ELSE '' END + ' + ' + ' ISNULL(CONVERT(varchar(2000),['+@ColName + '],0),''NULL'')' + ' COLLATE database_default + '
                      END  
              END
       END  

       FETCH NEXT FROM CR_Table INTO @ColName, @IsChar
 END

 CLOSE CR_Table
 DEALLOCATE CR_Table

 SELECT @Fields =  SUBSTRING(@Fields, 1,(len(@Fields)-1))

 SELECT @SelList =  SUBSTRING(@SelList, 1,(len(@SelList)-1))
 SELECT @SelList = @SelList + ' FROM ' + @table

 IF LEN(@restriction) &gt; 0
 BEGIN
       SELECT @SelList = @SelList + ' WHERE ' + @restriction
 END

 -- updated by Jane 20/08/08 added one line per column functionality as per Christian's suggestion
 SELECT @InsertStmt = @InsertStmt + CASE WHEN @GenerateOneLinePerColumn = 1 THEN REPLACE(@Fields,', ',',' + CHAR(13)) ELSE @Fields END + CASE WHEN @GenerateOneLinePerColumn = 1 THEN CHAR(13) ELSE '' END + ')'

 --for debugging purposes...
 IF @Debug = 1
 BEGIN
       PRINT '*** DEBUG INFORMATION - THIS IS THE SELECT STATEMENT BEING RUN *** '
       PRINT @sellist
       PRINT '*** END DEBUG ***'
 END

 -- added by Jane - 16/12/03
 SET NOCOUNT ON

 --now we need to create and load the temp table that will hold the data
 --that we are going to generate into an insert statement

 CREATE TABLE #TheData (TableData VARCHAR(max)) -- change this to be (8000) for SQL Server 2000
 INSERT INTO #TheData (TableData) EXEC (@SelList)

 --Cursor through the data to generate the INSERT statement / VALUES/SELECT/UNION SELECT clause
 DECLARE CR_Data CURSOR FAST_FORWARD FOR SELECT TableData FROM #TheData FOR
 READ ONLY
 OPEN CR_Data
 FETCH NEXT FROM CR_Data INTO @TableData

       WHILE (@@fetch_status &lt;&gt; -1)
       BEGIN
             IF (@@fetch_status &lt;&gt; -2)
             BEGIN                                            

                   -- Updated by Jane 17/04/09 instead of printing at this point, store the output in a @statementToOutput variable.  This allows us to try and split it to 
                   -- to print within the 8000 byte limit imposed by the PRINT function			
                   -- Updated by Jane 23/01/08 after suggestion posted to blog at http://jane.dallaway.com/blog/2007/11/generate-sql-insert-statement-from.html#c2055936172890486440
                   IF (@producesingleinsert = 1 )
                          IF (@bitInsertStatementPrinted = 0)
                          BEGIN
								SET @statementToOutput = @InsertStmt + char(13) + 'SELECT ' + @TableData                                    
                                SET @bitInsertStatementPrinted = 1
                          END
                          ELSE
                          BEGIN
								SET @statementToOutput = 'UNION SELECT ' + @TableData
                          END
                   ELSE
                   BEGIN
                          -- updated by Jane 20/08/08 added one line per column functionality as per Christian's suggestion
                          SET @statementToOutput =  @InsertStmt + CASE WHEN @GenerateOneLinePerColumn = 1 THEN CHAR(13) ELSE '' END + 'VALUES ' + + CASE WHEN @GenerateOneLinePerColumn = 1 THEN CHAR(13) ELSE '' END + '(' + CASE WHEN @GenerateOneLinePerColumn = 1 THEN CHAR(13) ELSE '' END + @TableData + CASE WHEN @GenerateOneLinePerColumn = 1 THEN CHAR(13) ELSE '' END + ')' + CHAR(13)
                   END

                   -- Added by Jane - 17/04/09 - check for length of @statementToOutput
                   -- if it exceeds the maximum length, then lets attempt to split it on CRs as these will be done via separate PRINT statements
                   IF DATALENGTH(@statementToOutput) &gt; @cintMaximumSupportedPrintByteCount                                                                                                                     
                   BEGIN                                                      

                       -- Break the @statementToOutput based on CHAR(13) and put separate data values into @statementsToOutput table

                       -- Get rid of double line breaks
                       -- Replace CHAR(10) with CHAR(13)
                       SET @statementToOutput = REPLACE(@statementToOutput,CHAR(10),CHAR(13))
                       -- Replace CHAR(13)+CHAR(13) with CHAR(13)
                       SET @statementToOutput = REPLACE(@statementToOutput,CHAR(13)+CHAR(13),CHAR(13))

                       SET @NextCR = Charindex(CHAR(13),@statementToOutput)
                       WHILE @NextCR  &gt; 0
                       BEGIN

                           INSERT INTO @statementsToOutput VALUES(LEFT(@statementToOutput,@NextCR - 1))

                           SET @statementToOutput = Right(@statementToOutput,Len(@statementToOutput) - @NextCR)
                           SET @NextCR = Charindex(CHAR(13),@statementToOutput)
                       END                           						   
                       INSERT INTO @statementsToOutput VALUES(@statementToOutput)				                                                                   

                       -- Output the statements line by line
					   SET @loop = 1
					   SET @id = -1

					   WHILE @loop = 1
					   BEGIN
                           SELECT TOP 1 @id = Id, @singleStatement = singlestatement
                           FROM @statementsToOutput
                           WHERE id &gt; @id
                           ORDER BY Id

                           SET @loop = @@ROWCOUNT

                           IF @loop = 0
                                BREAK

                           -- No guarantee that we still don't exceed the limits, but should have more of a chance of avoiding them
                           IF DATALENGTH(@singleStatement) &gt; @cintMaximumSupportedPrintByteCount
                           BEGIN
                                SET @bitDataExceedMaxPrintLength = 1
                                SELECT @singleStatement                           
                           END

                           PRINT @singleStatement
					   END													   
                   END    
                   ELSE
                   BEGIN					
                       -- Don't need to worry, we haven't exceeded the 8000 byte limit so just print it
					   PRINT @statementToOutput 
                   END

                   IF @generateGo = 1
                   BEGIN
                          PRINT 'GO'
                   END
             END
             FETCH NEXT FROM CR_Data INTO @TableData
       END
 CLOSE CR_Data
 DEALLOCATE CR_Data

 -- added by Jane - 07/11/03
 -- AND @GenerateIdentityColumn = 1 added by Jane - 07/01/09
 IF @bitIdentity = 1 AND @GenerateIdentityColumn = 1
 BEGIN
       PRINT 'SET IDENTITY_INSERT [' + @table + '] OFF '
 END

 -- added by Jane - 03/01/08
 PRINT '-- ** End of Inserts ** --'

 IF @bitHasEncounteredImage = 1
 BEGIN
       PRINT '-- ** WARNING: There is an image column in your table which has not been migrated - this has been replaced with NULL.  You will need to do this by hand.  Images are not supported by this script at this time.  ** --'
 END

 -- added by Jane - 15/01/08
 IF @bitHasEncounteredBinary = 1
 BEGIN
       PRINT '-- ** WARNING: There is a binary or varbinary column in your table which has not been migrated - this has been replaced with NULL.  You will need to do this by hand.  Binary and VarBinary are not supported by this script at this time.  ** --'
 END

 -- 16/02/09 - These checks are only required if the database is SQL Server 2000
 DECLARE @Version VARCHAR(100)
 SELECT @Version = @@VERSION
 IF PATINDEX('%8.00%',@Version) &gt; 0
 BEGIN
      IF @bitHasEncounteredXML = 1
      BEGIN
            PRINT '-- ** WARNING: This will convert any ''xml'' data to be ''varchar(8000)'' ** --'
      END

      -- added by Jane - 03/01/08
      IF @bitHasEncounteredText = 1 
      BEGIN
            PRINT '-- ** WARNING: This will convert any ''text'' or ''ntext'' data to be ''varchar(8000)'' ** --'
      END
 END

 IF @bitDataExceedMaxPrintLength = 1
 BEGIN
      PRINT '-- ** WARNING: The data length for at least one row exceeds '+ CONVERT(VARCHAR(6),@cintMaximumSupportedPrintByteCount) + ' bytes.  The PRINT command is limited to ' + CONVERT(VARCHAR(6),@cintMaximumSupportedPrintByteCount) + ' bytes (for more information see http://msdn.microsoft.com/en-us/library/ms176047.aspx).  Do not trust this data. ** --'
 END END ELSE BEGIN

 -- added by Jane - 16/04/2009 - Warn user that table doesn't exist
 PRINT REPLICATE('-', 43 + LEN(@table))     
 PRINT '-- Table ' + @table + ' doesn''t exist on this database --'
 PRINT REPLICATE('-', 43 + LEN(@table))
</pre></table></code></div></div><p>END RETURN (0)</p><p>GO ```&lt;/data&gt;&lt;/data&gt;</p><p>origin - http://www.pipiscrew.com/?p=2783 sql-generate-scripts-alternative</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/sql/'>sql</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=generate scripts + alternative - PipisCrew&url=/posts/generate-s/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=generate scripts + alternative - PipisCrew&u=/posts/generate-s/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=generate scripts + alternative - PipisCrew&url=/posts/generate-s/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/proper-con/"><div class="card-body"> <span class="timeago small" > Jun 23, 2017 <i class="unloaded">2017-06-23T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Proper convert UTC to Browser time</h3><div class="text-muted small"><p> 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 //src - //https://stackoverfl...</p></div></div></a></div><div class="card"> <a href="/posts/literate-s/"><div class="card-body"> <span class="timeago small" > Jun 25, 2017 <i class="unloaded">2017-06-25T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Literate SQL</h3><div class="text-muted small"><p> http://modern-sql.com/use-case/literate-sql origin - http://www.pipiscrew.com/?p=8694 literate-sql</p></div></div></a></div><div class="card"> <a href="/posts/ssl-securi/"><div class="card-body"> <span class="timeago small" > May 25 <i class="unloaded">2020-05-25T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>SSL Security Error for Microsoft SQL Driver</h3><div class="text-muted small"><p> We commonly see the following error from customers that migrate to us from providers that use an older SQL driver: [Microsoft][ODBC SQL Server Driver][DBNETLIB]SSL Security error or TCP P...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/dynamic-js/" class="btn btn-outline-primary"><p>Dynamic JSON Deserialization</p></a> <a href="/posts/c-implemen/" class="btn btn-outline-primary"><p>o[c] Implementing a dynamically sized array in C</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://twitter.com/pipiscrew">pipiscrew</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
