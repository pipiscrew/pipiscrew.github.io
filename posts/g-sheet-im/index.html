<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.6.2"><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="o[g] sheet ImportJSON" /><meta name="author" content="PipisCrew" /><meta property="og:locale" content="en_US" /><meta name="description" content="references https://github.com/fastfedora/google-docs https://medium.com/@paulgambill/how-to-import-json-data-into-google-spreadsheets-in-less-than-5-minutes-a3fede1a014a http://www.json-xls.com/json2xls (WARNING File Encoding must be UTF8)" /><meta property="og:description" content="references https://github.com/fastfedora/google-docs https://medium.com/@paulgambill/how-to-import-json-data-into-google-spreadsheets-in-less-than-5-minutes-a3fede1a014a http://www.json-xls.com/json2xls (WARNING File Encoding must be UTF8)" /><link rel="canonical" href="/posts/g-sheet-im/" /><meta property="og:url" content="/posts/g-sheet-im/" /><meta property="og:site_name" content="PipisCrew" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2017-04-17T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="o[g] sheet ImportJSON" /><meta name="twitter:site" content="@pipiscrew" /><meta name="twitter:creator" content="@PipisCrew" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@type":"BlogPosting","url":"/posts/g-sheet-im/","headline":"o[g] sheet ImportJSON","dateModified":"2017-04-17T00:00:00+08:00","datePublished":"2017-04-17T00:00:00+08:00","author":{"@type":"Person","name":"PipisCrew"},"mainEntityOfPage":{"@type":"WebPage","@id":"/posts/g-sheet-im/"},"description":"references https://github.com/fastfedora/google-docs https://medium.com/@paulgambill/how-to-import-json-data-into-google-spreadsheets-in-less-than-5-minutes-a3fede1a014a http://www.json-xls.com/json2xls (WARNING File Encoding must be UTF8)","@context":"https://schema.org"}</script><title>o[g] sheet ImportJSON | PipisCrew</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">PipisCrew</a></div><div class="site-subtitle font-italic">A text-focused Jekyll theme.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/pipiscrew" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/pipiscrew" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>o[g] sheet ImportJSON</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>o[g] sheet ImportJSON</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Apr 17, 2017, 12:00 AM +0800" > Apr 17, 2017 <i class="unloaded">2017-04-17T00:00:00+08:00</i> </span> by <span class="author"> PipisCrew </span></div></div><div class="post-content"><p>references <a href="https://github.com/fastfedora/google-docs">https://github.com/fastfedora/google-docs</a> <a href="https://medium.com/@paulgambill/how-to-import-json-data-into-google-spreadsheets-in-less-than-5-minutes-a3fede1a014a">https://medium.com/@paulgambill/how-to-import-json-data-into-google-spreadsheets-in-less-than-5-minutes-a3fede1a014a</a> <a href="http://www.json-xls.com/json2xls">http://www.json-xls.com/json2xls</a> (WARNING File Encoding must be UTF8)</p><p>1-Go to GoogleSheets &gt; create New 2-Tools <strong>Script Editor</strong> 3-Paste the following JS snippet, save it as ImportJSON</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://www.pipiscrew.com/wp-content/uploads/2016/02/snap181.png" alt="snap181" /></p><p>4-return back to Sheet, go to a cell and write</p><div class="language-js highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">=</span><span class="nx">ImportJSON</span><span class="p">(</span><span class="dl">"</span><span class="s2">http://date.jsontest.com/</span><span class="dl">"</span><span class="p">)</span>
</pre></table></code></div></div><p>at first, maybe doesnt appear at autocomplete <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://www.pipiscrew.com/wp-content/uploads/2016/02/snap180.png" alt="snap180" /></p><p>but will work..</p><p>```js /<em>====================================================================================================================================</em> ImportJSON by Trevor Lohrbeer (@FastFedora) ==================================================================================================================================== Version: 1.2.1 Project Page: http://blog.fastfedora.com/projects/import-json Copyright: (c) 2012-2013 by Trevor Lohrbeer License: GNU General Public License, version 3 (GPL-3.0) http://www.opensource.org/licenses/gpl-3.0.html ———————————————————————————————————————————— A library for importing JSON feeds into Google spreadsheets. Functions include:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> ImportJSON            For use by end users to import a JSON feed from a URL 
 ImportJSONViaPost     For use by end users to import a JSON feed from a URL using POST parameters
 ImportJSONAdvanced    For use by script developers to easily extend the functionality of this library
</pre></table></code></div></div><p>Future enhancements may include:</p><ul><li>Support for a real XPath like syntax similar to ImportXML for the query parameter<li>Support for OAuth authenticated APIs (see AddOAuthService__ function for failed experiment)</ul><p>Or feel free to write these and add on to the library yourself! ———————————————————————————————————————————— Changelog:</p><p>1.2.1 Fixed a bug with how nested arrays are handled. The rowIndex counter wasn’t incrementing properly when parsing. 1.2.0 Added ImportJSONViaPost and support for fetchOptions to ImportJSONAdvanced 1.1.1 Added a version number using Google Scripts Versioning so other developers can use the library 1.1 Added support for the noHeaders option 1.0 Initial release <em>====================================================================================================================================</em>/ /**</p><ul><li>Imports a JSON feed and returns the results to be inserted into a Google Spreadsheet. The JSON feed is flattened to create<li>a two-dimensional array. The first row contains the headers, with each column header indicating the path to that data in<li>the JSON feed. The remaining rows contain the data.<li><li>By default, data gets transformed so it looks more like a normal data import. Specifically: *<li><ul><li>Data from parent JSON elements gets inherited to their child elements, so rows representing child elements contain the values</ul><li>of the rows representing their parent elements.<li><ul><li>Values longer than 256 characters get truncated.</ul><li><ul><li>Headers have slashes converted to spaces, common prefixes removed and the resulting text converted to title case. *</ul><li>To change this behavior, pass in one of these values in the options parameter: *<li>noInherit: Don’t inherit values from parent elements<li>noTruncate: Don’t truncate values<li>rawHeaders: Don’t prettify headers<li>noHeaders: Don’t include headers, only the data<li>debugLocation: Prepend each value with the row &amp; column it belongs in *<li>For example: *<li>=ImportJSON(“http://gdata.youtube.com/feeds/api/standardfeeds/most_popular?v=2&amp;alt=json”, “/feed/entry/title,/feed/entry/content”,<li>“noInherit,noTruncate,rawHeaders”)<li><li>@param {url} the URL to a public JSON feed<li>@param {query} a comma-separated list of paths to import. Any path starting with one of these paths gets imported.<li>@param {parseOptions} a comma-separated list of options that alter processing of the data *<li>@return a two-dimensional array containing the data, with the first row containing headers **/ function ImportJSON(url, query, parseOptions) { return ImportJSONAdvanced(url, null, query, parseOptions, includeXPath_, defaultTransform_); }</ul><p>/**</p><ul><li>Imports a JSON feed via a POST request and returns the results to be inserted into a Google Spreadsheet. The JSON feed is<li>flattened to create a two-dimensional array. The first row contains the headers, with each column header indicating the path to<li>that data in the JSON feed. The remaining rows contain the data. *<li>To retrieve the JSON, a POST request is sent to the URL and the payload is passed as the content of the request using the content<li>type “application/x-www-form-urlencoded”. If the fetchOptions define a value for “method”, “payload” or “contentType”, these<li>values will take precedent. For example, advanced users can use this to make this function pass XML as the payload using a GET<li>request and a content type of “application/xml; charset=utf-8”. For more information on the available fetch options, see<li>https://developers.google.com/apps-script/reference/url-fetch/url-fetch-app . At this time the “headers” option is not supported.<li><li>By default, the returned data gets transformed so it looks more like a normal data import. Specifically: *<li><ul><li>Data from parent JSON elements gets inherited to their child elements, so rows representing child elements contain the values</ul><li>of the rows representing their parent elements.<li><ul><li>Values longer than 256 characters get truncated.</ul><li><ul><li>Headers have slashes converted to spaces, common prefixes removed and the resulting text converted to title case. *</ul><li>To change this behavior, pass in one of these values in the options parameter: *<li>noInherit: Don’t inherit values from parent elements<li>noTruncate: Don’t truncate values<li>rawHeaders: Don’t prettify headers<li>noHeaders: Don’t include headers, only the data<li>debugLocation: Prepend each value with the row &amp; column it belongs in *<li>For example: *<li>=ImportJSON(“http://gdata.youtube.com/feeds/api/standardfeeds/most_popular?v=2&amp;alt=json”, “user=bob&amp;apikey=xxxx”,<li>“validateHttpsCertificates=false”, “/feed/entry/title,/feed/entry/content”, “noInherit,noTruncate,rawHeaders”)<li><li>@param {url} the URL to a public JSON feed<li>@param {payload} the content to pass with the POST request; usually a URL encoded list of parameters separated by ampersands<li>@param {fetchOptions} a comma-separated list of options used to retrieve the JSON feed from the URL<li>@param {query} a comma-separated list of paths to import. Any path starting with one of these paths gets imported.<li>@param {parseOptions} a comma-separated list of options that alter processing of the data *<li>@return a two-dimensional array containing the data, with the first row containing headers **/ function ImportJSONViaPost(url, payload, fetchOptions, query, parseOptions) { var postOptions = parseToObject_(fetchOptions);</ul><p>if (postOptions[“method”] == null) { postOptions[“method”] = “POST”; }</p><p>if (postOptions[“payload”] == null) { postOptions[“payload”] = payload; }</p><p>if (postOptions[“contentType”] == null) { postOptions[“contentType”] = “application/x-www-form-urlencoded”; }</p><p>convertToBool_(postOptions, “validateHttpsCertificates”); convertToBool_(postOptions, “useIntranet”); convertToBool_(postOptions, “followRedirects”); convertToBool_(postOptions, “muteHttpExceptions”);</p><p>return ImportJSONAdvanced(url, postOptions, query, parseOptions, includeXPath_, defaultTransform_); }</p><p>/**</p><ul><li>An advanced version of ImportJSON designed to be easily extended by a script. This version cannot be called from within a<li>spreadsheet.<li><li>Imports a JSON feed and returns the results to be inserted into a Google Spreadsheet. The JSON feed is flattened to create<li>a two-dimensional array. The first row contains the headers, with each column header indicating the path to that data in<li>the JSON feed. The remaining rows contain the data. *<li>The fetchOptions can be used to change how the JSON feed is retrieved. For instance, the “method” and “payload” options can be<li>set to pass a POST request with post parameters. For more information on the available parameters, see<li>https://developers.google.com/apps-script/reference/url-fetch/url-fetch-app . *<li>Use the include and transformation functions to determine what to include in the import and how to transform the data after it is<li>imported. *<li>For example: *<li>ImportJSON(“http://gdata.youtube.com/feeds/api/standardfeeds/most_popular?v=2&amp;alt=json”,<li>new Object() { “method” : “post”, “payload” : “user=bob&amp;apikey=xxxx” },<li>“/feed/entry”,<li>””,<li>function (query, path) { return path.indexOf(query) == 0; },<li>function (data, row, column) { data[row][column] = data[row][column].toString().substr(0, 100); } ) *<li>In this example, the import function checks to see if the path to the data being imported starts with the query. The transform<li>function takes the data and truncates it. For more robust versions of these functions, see the internal code of this library. *<li>@param {url} the URL to a public JSON feed<li>@param {fetchOptions} an object whose properties are options used to retrieve the JSON feed from the URL<li>@param {query} the query passed to the include function<li>@param {parseOptions} a comma-separated list of options that may alter processing of the data<li>@param {includeFunc} a function with the signature func(query, path, options) that returns true if the data element at the given path<li>should be included or false otherwise.<li>@param {transformFunc} a function with the signature func(data, row, column, options) where data is a 2-dimensional array of the data<li>and row &amp; column are the current row and column being processed. Any return value is ignored. Note that row 0<li>contains the headers for the data, so test for row==0 to process headers only. *<li>@return a two-dimensional array containing the data, with the first row containing headers **/ function ImportJSONAdvanced(url, fetchOptions, query, parseOptions, includeFunc, transformFunc) { var jsondata = UrlFetchApp.fetch(url, fetchOptions); var object = JSON.parse(jsondata.getContentText());</ul><p>return parseJSONObject_(object, query, parseOptions, includeFunc, transformFunc); }</p><p>/**</p><ul><li>Encodes the given value to use within a URL. *<li>@param {value} the value to be encoded<li><li>@return the value encoded using URL percent-encoding */ function URLEncode(value) { return encodeURIComponent(value.toString());<br /> }</ul><p>/**</p><ul><li>Adds an oAuth service using the given name and the list of properties. *<li>@note This method is an experiment in trying to figure out how to add an oAuth service without having to specify it on each<li>ImportJSON call. The idea was to call this method in the first cell of a spreadsheet, and then use ImportJSON in other<li>cells. This didn’t work, but leaving this in here for further experimentation later. *<li>The test I did was to add the following into the A1:<li><li>=AddOAuthService(“twitter”, “https://api.twitter.com/oauth/access_token”,<li>“https://api.twitter.com/oauth/request_token”, “https://api.twitter.com/oauth/authorize”,<li>“<my consumer="" key="">", "<my consumer="" secret="">", "", "") *</my></my><li>Information on obtaining a consumer key &amp; secret for Twitter can be found at https://dev.twitter.com/docs/auth/using-oauth *<li>Then I added the following into A2: *<li>=ImportJSONViaPost(“https://api.twitter.com/1.1/statuses/user_timeline.json?screen_name=fastfedora&amp;count=2”, “”,<li>“oAuthServiceName=twitter,oAuthUseToken=always”, “/”, “”) *<li>I received an error that the “oAuthServiceName” was not a valid value. [twl 18.Apr.13] */ function AddOAuthService__(name, accessTokenUrl, requestTokenUrl, authorizationUrl, consumerKey, consumerSecret, method, paramLocation) { var oAuthConfig = UrlFetchApp.addOAuthService(name);</ul><p>if (accessTokenUrl != null &amp;&amp; accessTokenUrl.length &gt; 0) { oAuthConfig.setAccessTokenUrl(accessTokenUrl); }</p><p>if (requestTokenUrl != null &amp;&amp; requestTokenUrl.length &gt; 0) { oAuthConfig.setRequestTokenUrl(requestTokenUrl); }</p><p>if (authorizationUrl != null &amp;&amp; authorizationUrl.length &gt; 0) { oAuthConfig.setAuthorizationUrl(authorizationUrl); }</p><p>if (consumerKey != null &amp;&amp; consumerKey.length &gt; 0) { oAuthConfig.setConsumerKey(consumerKey); }</p><p>if (consumerSecret != null &amp;&amp; consumerSecret.length &gt; 0) { oAuthConfig.setConsumerSecret(consumerSecret); }</p><p>if (method != null &amp;&amp; method.length &gt; 0) { oAuthConfig.setMethod(method); }</p><p>if (paramLocation != null &amp;&amp; paramLocation.length &gt; 0) { oAuthConfig.setParamLocation(paramLocation); } }</p><p>/**</p><ul><li>Parses a JSON object and returns a two-dimensional array containing the data of that object. */ function parseJSONObject_(object, query, options, includeFunc, transformFunc) { var headers = new Array(); var data = new Array();</ul><p>if (query &amp;&amp; !Array.isArray(query) &amp;&amp; query.toString().indexOf(“,”) != -1) { query = query.toString().split(“,”); }</p><p>if (options) { options = options.toString().split(“,”); }</p><p>parseData_(headers, data, “”, {rowIndex: 1}, object, query, options, includeFunc); parseHeaders_(headers, data); transformData_(data, options, transformFunc);</p><p>return hasOption_(options, “noHeaders”) ? (data.length &gt; 1 ? data.slice(1) : new Array()) : data; }</p><p>/**</p><ul><li>Parses the data contained within the given value and inserts it into the data two-dimensional array starting at the rowIndex.<li>If the data is to be inserted into a new column, a new header is added to the headers array. The value can be an object,<li>array or scalar value. *<li>If the value is an object, it’s properties are iterated through and passed back into this function with the name of each<li>property extending the path. For instance, if the object contains the property “entry” and the path passed in was “/feed”,<li>this function is called with the value of the entry property and the path “/feed/entry”. *<li>If the value is an array containing other arrays or objects, each element in the array is passed into this function with<li>the rowIndex incremeneted for each element. *<li>If the value is an array containing only scalar values, those values are joined together and inserted into the data array as<li>a single value. *<li>If the value is a scalar, the value is inserted directly into the data array. */ function parseData_(headers, data, path, state, value, query, options, includeFunc) { var dataInserted = false;</ul><p>if (Array.isArray(value) &amp;&amp; isObjectArray_(value)) { for (var i = 0; i &lt; value.length;=”” i++)=”” {=”” if=”” (parsedata_(headers,=”” data,=”” path,=”” state,=”” value[i],=”” query,=”” options,=”” includefunc))=”” {=”” datainserted=”true;” if=”” (i=””&gt; 0 &amp;&amp; data[state.rowIndex]) { state.rowIndex++; } } } } else if (isObject_(value)) { for (key in value) { if (parseData_(headers, data, path + “/” + key, state, value[key], query, options, includeFunc)) { dataInserted = true; } } } else if (!includeFunc || includeFunc(query, path, options)) { // Handle arrays containing only scalar values if (Array.isArray(value)) { value = value.join(); }</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>// Insert new row if one doesn't already exist
if (!data[state.rowIndex]) {
  data[state.rowIndex] = new Array();
}

// Add a new header if one doesn't exist
if (!headers[path] &amp;&amp; headers[path] != 0) {
  headers[path] = Object.keys(headers).length;
}

// Insert the data
data[state.rowIndex][headers[path]] = value;
dataInserted = true;   }
</pre></table></code></div></div><p>return dataInserted; }</p><p>/**</p><ul><li>Parses the headers array and inserts it into the first row of the data array. */ function parseHeaders_(headers, data) { data[0] = new Array();</ul><p>for (key in headers) { data[0][headers[key]] = key; } }</p><p>/**</p><ul><li><p>Applies the transform function for each element in the data array, going through each column of each row. */ function transformData_(data, options, transformFunc) { for (var i = 0; i &lt; data.length;=”” i++)=”” {=”” for=”” (var=”” j=”0;” j=””&gt;&lt; data[i].length;=”” j++)=”” {=”” transformfunc(data,=”” i,=”” j,=”” options);=”” }=”” }=”” }=”” **=”” *=”” returns=”” true=”” if=”” the=”” given=”” test=”” value=”” is=”” an=”” object;=”” false=”” otherwise.=”” */=”” function=”” isobject_(test)=”” {=”” return=”” object.prototype.tostring.call(test)=”==” ‘[object=”” object]’;=”” }=”” **=”” *=”” returns=”” true=”” if=”” the=”” given=”” test=”” value=”” is=”” an=”” array=”” containing=”” at=”” least=”” one=”” object;=”” false=”” otherwise.=”” */=”” function=”” isobjectarray_(test)=”” {=”” for=”” (var=”” i=”0;” i=””&gt;&lt; test.length;=”” i++)=”” {=”” if=”” (isobject_(test[i]))=”” {=”” return=”” true;=”” }=”” }=”” return=”” false;=”” }=”” **=”” *=”” returns=”” true=”” if=”” the=”” given=”” query=”” applies=”” to=”” the=”” given=”” path.=”” */=”” function=”” includexpath_(query,=”” path,=”” options)=”” {=”” if=”” (!query)=”” {=”” return=”” true;=”” }=”” else=”” if=”” (array.isarray(query))=”” {=”” for=”” (var=”” i=”0;” i=””&gt;&lt; query.length;=”” i++)=”” {=”” if=”” (applyxpathrule_(query[i],=”” path,=”” options))=”” {=”” return=”” true;=”” }=”” }=”” }=”” else=”” {=”” return=”” applyxpathrule_(query,=”” path,=”” options);=”” }=”” return=”” false;=”” };=”” **=”” *=”” returns=”” true=”” if=”” the=”” rule=”” applies=”” to=”” the=”” given=”” path.=”” */=”” function=”” applyxpathrule_(rule,=”” path,=”” options)=”” {=”” return=”” path.indexof(rule)=”=” 0;=”” }=”” **=”” *=”” by=”” default,=”” this=”” function=”” transforms=”” the=”” value=”” at=”” the=”” given=”” row=”” &amp;=”” column=”” so=”” it=”” looks=”” more=”” like=”” a=”” normal=”” data=”” import.=”” specifically:=”” *=”” *=”” -=”” data=”” from=”” parent=”” json=”” elements=”” gets=”” inherited=”” to=”” their=”” child=”” elements,=”” so=”” rows=”” representing=”” child=”” elements=”” contain=”” the=”” values=”” *=”” of=”” the=”” rows=”” representing=”” their=”” parent=”” elements.=”” *=”” -=”” values=”” longer=”” than=”” 256=”” characters=”” get=”” truncated.=”” *=”” -=”” values=”” in=”” row=”” 0=”” (headers)=”” have=”” slashes=”” converted=”” to=”” spaces,=”” common=”” prefixes=”” removed=”” and=”” the=”” resulting=”” text=”” converted=”” to=”” title=”” *=”” case.=”” *=”” *=”” to=”” change=”” this=”” behavior,=”” pass=”” in=”” one=”” of=”” these=”” values=”” in=”” the=”” options=”” parameter:=”” *=”” *=”” noinherit:=”” don’t=”” inherit=”” values=”” from=”” parent=”” elements=”” *=”” notruncate:=”” don’t=”” truncate=”” values=”” *=”” rawheaders:=”” don’t=”” prettify=”” headers=”” *=”” debuglocation:=”” prepend=”” each=”” value=”” with=”” the=”” row=”” &amp;=”” column=”” it=”” belongs=”” in=”” */=”” function=”” defaulttransform_(data,=”” row,=”” column,=”” options)=”” {=”” if=”” (!data[row][column])=”” {=”” if=”” (row=””&gt;&lt; 2=”” ||=”” hasoption_(options,=”” “noinherit”))=”” {=”” data[row][column]=”” ;=”” }=”” else=”” {=”” data[row][column]=”data[row-1][column];” }=”” }=”” if=”” (!hasoption_(options,=”” “rawheaders”)=”” &amp;&amp;=”” row=”=” 0)=”” {=”” if=”” (column=”=” 0=”” &amp;&amp;=”” data[row].length=””&gt; 1) { removeCommonPrefixes_(data, row);<br /> }</p><p>data[row][column] = toTitleCase_(data[row][column].toString().replace(/[\/_]/g, “ “)); }</p></ul><p>if (!hasOption_(options, “noTruncate”) &amp;&amp; data[row][column]) { data[row][column] = data[row][column].toString().substr(0, 256); }</p><p>if (hasOption_(options, “debugLocation”)) { data[row][column] = “[” + row + “,” + column + “]” + data[row][column]; } }</p><p>/**</p><ul><li>If all the values in the given row share the same prefix, remove that prefix. */ function removeCommonPrefixes_(data, row) { var matchIndex = data[row][0].length;</ul><p>for (var i = 1; i &lt; data[row].length;=”” i++)=”” {=”” matchindex=”findEqualityEndpoint_(data[row][i-1],” data[row][i],=”” matchindex);=”” if=”” (matchindex=”=” 0)=”” {=”” return;=”” }=”” }=”” for=”” (var=”” i=”0;” i=””&gt;&lt; data[row].length;=”” i++)=”” {=”” data[row][i]=”data[row][i].substring(matchIndex,” data[row][i].length);=”” }=”” }=”” <em>*=”” *=”” locates=”” the=”” index=”” where=”” the=”” two=”” strings=”” values=”” stop=”” being=”” equal,=”” stopping=”” automatically=”” at=”” the=”” stopat=”” index.=”” */=”” function=”” findequalityendpoint_(string1,=”” string2,=”” stopat)=”” {=”” if=”” (!string1=”” ||=”” !string2)=”” {=”” return=”” -1;=”” }=”” var=”” maxendpoint=”Math.min(stopAt,” string1.length,=”” string2.length);=”” for=”” (var=”” i=”0;” i=””&gt;&lt; maxendpoint;=”” i++)=”” {=”” if=”” (string1.charat(i)=”” !=”string2.charAt(i))” {=”” return=”” i;=”” }=”” }=”” return=”” maxendpoint;=”” }=”” **=”” *=”” converts=”” the=”” text=”” to=”” title=”” case.=”” */=”” function=”” totitlecase_(text)=”” {=”” if=”” (text=”=” null)=”” {=”” return=”” null;=”” }=”” return=”” text.replace(/\w\s</em>/g,=”” function(word)=”” {=”” return=”” word.charat(0).touppercase()=”” +=”” word.substr(1).tolowercase();=”” });=”” }=”” **=”” *=”” returns=”” true=”” if=”” the=”” given=”” set=”” of=”” options=”” contains=”” the=”” given=”” option.=”” */=”” function=”” hasoption_(options,=”” option)=”” {=”” return=”” options=”” &amp;&amp;=”” options.indexof(option)=””&gt;= 0; }</p><p>/**</p><ul><li>Parses the given string into an object, trimming any leading or trailing spaces from the keys. */ function parseToObject_(text) { var map = new Object(); var entries = (text != null &amp;&amp; text.trim().length &gt; 0) ? text.toString().split(“,”) : new Array();</ul><p>for (var i = 0; i &lt; entries.length;=”” i++)=”” {=”” addtomap_(map,=”” entries[i]);=”” }=”” return=”” map;=”” }=”” **=”” *=”” parses=”” the=”” given=”” entry=”” and=”” adds=”” it=”” to=”” the=”” given=”” map,=”” trimming=”” any=”” leading=”” or=”” trailing=”” spaces=”” from=”” the=”” key.=”” */=”” function=”” addtomap_(map,=”” entry)=”” {=”” var=”” equalsindex=”entry.indexOf(“ =”);”=”” var=”” key=”(equalsIndex” !=”-1)” entry.substring(0,=”” equalsindex)=”” :=”” entry;=”” var=”” value=”(key.length” +=”” 1=””&gt;&lt; entry.length)=”” entry.substring(key.length=”” +=”” 1)=”” :=”” “”;=”” map[key.trim()]=”value;” }=”” **=”” *=”” returns=”” the=”” given=”” value=”” as=”” a=”” boolean.=”” */=”” function=”” tobool_(value)=”” {=”” return=”” value=”=” null=”” false=”” :=”” (value.tostring().tolowercase()=”=” “true”=”” true=”” :=”” false);=”” }=”” **=”” *=”” converts=”” the=”” value=”” for=”” the=”” given=”” key=”” in=”” the=”” given=”” map=”” to=”” a=”” bool.=”” */=”” function=”” converttobool_(map,=”” key)=”” {=”” if=”” (map[key]=”” !=”null)” {=”” map[key]=”tobool_(map[key]);” }=”” }=”” ```=”” entry.length)=”” entry.substring(key.length=”” +=”” 1)=”” :=”” “”;=”” map[key.trim()]=”value;” }=”” **=”” *=”” returns=”” the=”” given=”” value=”” as=”” a=”” boolean.=”” */=”” function=”” tobool_(value)=”” {=”” return=”” value=”=” null=”” false=”” :=”” (value.tostring().tolowercase()=”=” “true”=”” true=”” :=”” false);=”” }=”” **=”” *=”” converts=”” the=”” value=”” for=”” the=”” given=”” key=”” in=”” the=”” given=”” map=”” to=”” a=”” bool.=”” */=”” function=”” converttobool_(map,=”” key)=”” {=”” if=”” (map[key]=”” !=”null)” {=”” map[key]=”toBool_(map[key]);” }=”” }=””&gt;&lt;/my&gt;&lt;/my&gt;</p><p>origin - http://www.pipiscrew.com/?p=4000 g-sheet-importjson</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/app/'>app</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=o[g] sheet ImportJSON - PipisCrew&url=/posts/g-sheet-im/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=o[g] sheet ImportJSON - PipisCrew&u=/posts/g-sheet-im/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=o[g] sheet ImportJSON - PipisCrew&url=/posts/g-sheet-im/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/shakydraw/"><div class="card-body"> <span class="timeago small" > Jun 22, 2017 <i class="unloaded">2017-06-22T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ShakyDraw</h3><div class="text-muted small"><p> Beautiful hand-drawn block diagrams from plain text http://shakydraw.com/ #flowchart origin - http://www.pipiscrew.com/2017/06/shakydraw/ shakydraw</p></div></div></a></div><div class="card"> <a href="/posts/holo/"><div class="card-body"> <span class="timeago small" > Jun 23, 2017 <i class="unloaded">2017-06-23T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Holo</h3><div class="text-muted small"><p> Add holograms into your real-world. https://thisisholo.com/ https://play.google.com/store/apps/details?id=com.eighti.holo.android origin - http://www.pipiscrew.com/2017/06/holo/ holo</p></div></div></a></div><div class="card"> <a href="/posts/ironnode/"><div class="card-body"> <span class="timeago small" > May 23 <i class="unloaded">2020-05-23T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ironNode - debug noeJS code with Chrome developer tools</h3><div class="text-muted small"><p> https://www.electronjs.org/apps/ironnode origin - https://www.pipiscrew.com/?p=18407 ironnode-debug-noejs-code-with-chrome-developer-tools</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/did-i-do-o/" class="btn btn-outline-primary"><p>Did I do okay?</p></a> <a href="/posts/good-game/" class="btn btn-outline-primary"><p>Good game mate</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://twitter.com/pipiscrew">pipiscrew</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
