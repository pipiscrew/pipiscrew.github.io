---
title: Angular2 - Adding service to interact with a PHP web service
author: PipisCrew
date: 2017-03-20
categories: [php,angular]
toc: true
---

# <span lang="EN-US">Creating the first form</span>

<span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: green; background: white;">// http://blog.ng-book.com/the-ultimate-guide-to-forms-in-angular-2/</span> <span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: green; background: white;">// https://angular.io/docs/ts/latest/guide/forms.html</span>

When **ngModel** is <u>without attribute</u> value <span lang="EN-US">is</span> #***one-way data binding***#

examples for #***two-way data binding***#

```js//Example 1 
<input [(ngmodel)]="person.firstName" name="first">```

```js//Example 2
<input [(ngmodel)]="person.firstName" [ngmodeloptions]="{standalone: true}">```

<span lang="EN-US" style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

**<span lang="EN-US" style="color: #e36c0a;">x.module.ts</span>** must import ****:

<span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: black; background: white;">import { FormsModule } from </span><span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: #a31515; background: white;">'@angular/forms'</span><span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: black; background: white;">;</span>

<span lang="EN-US" style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span lang="EN-US" style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

**<span lang="EN-US" style="color: #e36c0a;">x.component.html</span>**:

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"><form (ngsubmit)=""></span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">"</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: lime;">tryLogin</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">(</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: yellow;">myForm.value</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">)"</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> #</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: yellow;">myForm</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">="ngForm"></span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> <div layout=""></div></span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">"column"</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">></span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> <div flex=""></div></span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> <md-input-container></md-input-container></span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> <input mdinput="" placeholder=""></span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">"Username"</span> <span style="font-size: 9.5pt; font-family: Consolas; color: black; background: yellow;">name</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">=</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">"username"</span> <span style="font-size: 9.5pt; font-family: Consolas; color: black; background: yellow;">ngModel</span> <span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">required></span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> <div flex=""></div></span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> <md-input-container></md-input-container></span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> <input mdinput="" placeholder=""></span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">"Password"</span> <span style="font-size: 9.5pt; font-family: Consolas; color: black; background: yellow;">name</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">=</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">"password"</span> <span style="font-size: 9.5pt; font-family: Consolas; color: black; background: yellow;">ngModel</span> <span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">required></span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> <button md-raised-button="" color=""></button></span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">"accent"</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> type=</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">"submit"</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">>Log </span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">in</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"></span>

<span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: black; background: white;"></form></span>

**<span lang="EN-US" style="color: #e36c0a;">x.component.ts </span>**:

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">import { Component } from </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'@angular/core'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">;</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">@Component({</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> selector: </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'app-root'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">,</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> templateUrl: </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'./x.component.html'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">,</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> styleUrls: [</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'./x.component.css'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">]</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">})</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">export </span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">class</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> AppComponent {</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: lime;">tryLogin</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">(</span><span style="font-size: 9.5pt; font-family: Consolas; color: black;">form_data<span style="background: white;">: any){</span></span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> console.log(</span><span style="font-size: 9.5pt; font-family: Consolas; color: black;">form_data<span style="background: white;">);</span></span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> console.log(</span><span style="font-size: 9.5pt; font-family: Consolas; color: black;">form_data<span style="background: white;">.username);</span></span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> }</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: black; background: white;">}</span>

<span lang="EN-US">When click the **Log in** button</span>

![](https://www.pipiscrew.com/wp-content/uploads/2017/03/image014.png)

<span lang="EN-US" style="font-size: 11.0pt; line-height: 115%; font-family: 'Calibri','sans-serif';"> </span>

**<span lang="EN-US" style="font-size: 14.0pt; line-height: 115%; font-family: 'Cambria','serif'; color: #365f91;"> </span>**

# <span lang="EN-US">Adding service to interact with a PHP web service</span>

<span lang="EN-US">Create a file **<span style="color: #e36c0a;">service.ts</span>**</span>

<span style="background: white;">Angular2 **automatically detects that the input is a raw object**, adds the C**ontent-Type : application/json**.</span>

## <span lang="EN-US" style="background: white;">Option1</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">let g = {</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'name'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> : user,</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'password'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> : password</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">}</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: yellow;">let body = JSON.stringify(g);</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: blue; background: white;">return</span> <span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: blue; background: white;">this</span><span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: black; background: white;">.http.post(</span><span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: #a31515; background: white;">"http://localhost/login.php"</span><span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: black; background: white;">, body);</span>

## <span lang="EN-US" style="background: white;">Option2</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">let </span><span lang="EN-US" style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">body</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> = {</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'name'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> : user,</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'password'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> : password</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">}</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: blue; background: white;">return</span> <span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: blue; background: white;">this</span><span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: black; background: white;">.http.post(</span><span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: #a31515; background: white;">"http://localhost/login.php"</span><span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: black; background: white;">, body);</span>

<span lang="EN-US" style="color: red; background: white;">Im using two servers (locahost:4200 and localhost (xampp)) – when using this option we have 2 calls to server, asking what the destination server supports. ****Tested when the files are on the same server the <u>call is one</u>****</span><span lang="EN-US" style="font-size: 16.0pt; line-height: 115%; color: red;"> </span>![](https://www.pipiscrew.com/wp-content/uploads/2017/03/image015.jpg)

<span style="font-size: 9.5pt; font-family: Consolas; color: green; background: white;">// http://stackoverflow.com/a/21783145</span>

<span style="background: white;">This is happening because Im using separated servers for the calls</span>

<span lang="EN-US">"preflighted" requests first send an HTTP request by the OPTIONS method to the resource on the other domain, in order to determine whether the actual request is safe to send. Cross-site requests are preflighted like this since they may have implications to user data. </span>

<span style="background: white;">My </span>**<span lang="EN-US" style="color: #e36c0a;">login.php</span>**<span style="background: white;"> is as the following</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"><></span>

<span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: green; background: white;">//</span><span lang="EN-US" style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: green; background: white;">not safe on live server</span>

<span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: green; background: white;">//header('Access-Control-Allow-Origin: *');</span>

<span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: green; background: white;">//header('Access-Control-Allow-Methods: GET, POST, PATCH, PUT, DELETE, OPTIONS');</span>

<span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: green; background: white;">//header('Access-Control-Allow-Headers: Origin, Content-Type, X-Auth-Token');</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">if</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> ($_SERVER[</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'REQUEST_METHOD'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">] === </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'POST'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">) {</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> var_dump($_POST);</span>

<span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: black; background: white;">}</span>

<span lang="EN-US" style="background: white;"> </span>

<span style="background: white;">Using **Option1** or **Option2** the </span>**<span lang="EN-US" style="color: #e36c0a;">login.php</span>** **<span style="background: white;">cant</span>**<span style="background: white;"> handle it</span><span lang="EN-US" style="background: white;">, is **$_POST**, but empty one.</span>

![](https://www.pipiscrew.com/wp-content/uploads/2017/03/image016.png)

<span lang="EN-US" style="background: white;">The cause : </span><span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: green; background: white;">// http://stackoverflow.com/a/20295138</span>

<span lang="EN-US">When using </span>**<span style="background: white;">Content-Type : application/json</span>** <span lang="EN-US">you will not be able to rely on **$_POST** being populated. **<span style="background: yellow;">$_POST</span>**<span style="background: yellow;"> is only populated for **form-encoded content types**</span>**.**</span>

<span lang="EN-US" style="font-size: 9.5pt; font-family: Consolas; color: green; background: white;"> </span>

<span lang="EN-US" style="font-size: 9.5pt; font-family: Consolas; color: green; background: white;"> </span>

<span style="background: white;">modify the header</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">let g = {</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'name'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> : user,</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'password'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> : password</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">}</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">let body = JSON.stringify(g);</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: yellow;">let headers = </span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: yellow;">new</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: yellow;"> Headers();</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: yellow;">headers.append(</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: yellow;">'Content-Type'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: yellow;">, </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: yellow;">'application/x-www-form-urlencoded; charset=UTF-8'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: yellow;">);</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">return</span> <span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">this</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">.http.post(</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'http://localhost/login.php',body, { </span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: yellow;">headers</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> });</span>

<span lang="EN-US" style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

![](https://www.pipiscrew.com/wp-content/uploads/2017/03/image017.png)

<span lang="EN-US" style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">Crazy ? The Angular json made **array key** </span><span lang="EN-US" style="font-size: 9.5pt; font-family: Wingdings; color: black; background: white;">J</span>

<span lang="EN-US" style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span lang="EN-US">Reconstructing **<span style="color: #e36c0a;">login.php</span>**</span>, ****we can read the JSON

<span lang="EN-US" style="font-size: 9.5pt; font-family: Consolas; color: green; background: white;">// </span><span style="font-size: 9.5pt; font-family: Consolas; color: green; background: white;">http://php.net/manual/en/function.key.php</span><span lang="EN-US" style="font-size: 9.5pt; font-family: Consolas; color: green; background: white;"> // </span><span lang="EN-US" style="font-size: 9.5pt; font-family: Consolas; color: green;">http://stackoverflow.com/a/467187 -- What is the max key size for an array in PHP? - A quick test got me a key of 128mb no problem.</span>

<span lang="EN-US" style="font-size: 9.5pt; font-family: Consolas; color: green; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">if</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> ($_SERVER[</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'REQUEST_METHOD'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">] ===</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'POST'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">) {</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> $_POST = json_decode(key($_POST), </span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">true</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">);</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> var_dump($_POST);</span>

<span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: black; background: white;">}</span>

![](https://www.pipiscrew.com/wp-content/uploads/2017/03/image018.png)

<span lang="EN-US">Many people mention to read the **php://input** (for sure Im not going with this) -- </span><span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: green; background: white;">http://stackoverflow.com/a/24140930</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">if</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> ($_SERVER[</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'REQUEST_METHOD'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">] == </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'POST'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">&& empty($_POST))</span>

<span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: black; background: white;"> $_POST = json_decode(file_get_contents(</span><span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: #a31515; background: white;">'php://input'</span><span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: black; background: white;">), </span><span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: blue; background: white;">true</span><span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: black; background: white;">);</span>

**<span lang="EN-US">[flavor1] </span>**<span lang="EN-US">Complete **<span style="color: #e36c0a;">service.ts</span>** working with PHP</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">import { Injectable } from </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'@angular/core'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">;</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">import { Http, Headers</span> <span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">} from </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'@angular/http'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">;</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">import </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'rxjs/Rx'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">;</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">@Injectable()</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">export </span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">class</span> <span style="font-size: 9.5pt; font-family: Consolas; color: #2b91af; background: white;">WebService</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> {</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> constructor (</span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">private</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> http: Http) {}</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">public</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> loginUser(user:</span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">string</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">, password:</span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">string</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">) {</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> let g = {</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'name'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> : user,</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'password'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> : password</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> }</span>

<span lang="EN-US" style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> let body = JSON.stringify(g);</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> let headers = </span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">new </span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">Headers();</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> headers.append(</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'Content-Type'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">, </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'application/x-www-form-urlencoded; charset=UTF-8'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">);</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">return</span> <span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">this</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">.http.post(</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'http://localhost/login.php'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">, body, { headers });</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> }</span>

<span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: black; background: white;">}</span>

**<span lang="EN-US">[flavor2] </span>**<span lang="EN-US">Modify **<span style="color: #e36c0a;">service.ts</span>** to **serialize the objects** (as *jQuery.ajax* doing till now), no PHP troubles.</span>

<span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: green; background: white;">// http://restlet.com/company/blog/2016/08/29/whats-new-in-the-http-module-of-angular-2/</span><span lang="EN-US" style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: green; background: white;"> // https://angular.io/docs/ts/latest/api/http/index/URLSearchParams-class.html</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">import { Injectable } from </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'@angular/core'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">;</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">import { Http, URLSearchParams } from </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'@angular/http'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">;</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">import </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'rxjs/Rx'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">;</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">@Injectable()</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">export </span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">class</span> <span style="font-size: 9.5pt; font-family: Consolas; color: #2b91af; background: white;">WebService</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> {</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> constructor (</span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">private</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> http: Http) {}</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">public</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> loginUser(user:</span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">string</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">, password:</span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">string</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">) {</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> let body = </span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">new</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> URLSearchParams();</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> body.set(</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'name'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">, user);</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> body.set(</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'password'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">, password);</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">return</span> <span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">this</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">.http.post(</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'http://localhost/login.php', body);</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> }</span>

<span style="font-size: 9.5pt; line-height: 115%; font-family: Consolas; color: black; background: white;">}</span>

**<span lang="EN-US" style="color: #e36c0a;">x.component.ts </span>**:

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">import { Component } from </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'@angular/core'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">;</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: yellow;">import { WebService } from </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: yellow;">'./service'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: yellow;">;</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">@Component({</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> selector: </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'app-root'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">,</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> templateUrl: </span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'./app.component.html'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">,</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> styleUrls: [</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">'./app.component.css'</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">],</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: yellow;">providers: [WebService]</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">})</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">export </span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: white;">class</span> <span style="font-size: 9.5pt; font-family: Consolas; color: #2b91af; background: white;">AppComponent</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> {</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: yellow;">constructor(</span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: yellow;">private</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: yellow;"> webService: WebService) { }</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> tryLogin(form_data: any){</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span><span style="font-size: 9.5pt; font-family: Consolas; color: blue; background: yellow;">this</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: yellow;">.webService</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">.loginUser(form_data.username, form_data.password).map(res => res.json()).subscribe((data)=> console.log(data), (err) => console.log(</span><span style="font-size: 9.5pt; font-family: Consolas; color: #a31515; background: white;">"error occured"</span><span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;">, err));</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> </span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> console.log(form_data);</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> console.log(form_data.username);</span>

<span style="font-size: 9.5pt; font-family: Consolas; color: black; background: white;"> }}</span>

origin - http://www.pipiscrew.com/?p=7273 angular2-adding-service-to-interact-with-a-php-web-service